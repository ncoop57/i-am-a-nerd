<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>How to Create an Automatic Code Comment Generator using Deep Learning! | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="How to Create an Automatic Code Comment Generator using Deep Learning!" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A tutorial for automatically generate code comments using Deep Learning." />
<meta property="og:description" content="A tutorial for automatically generate code comments using Deep Learning." />
<link rel="canonical" href="https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html" />
<meta property="og:url" content="https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:image" content="https://nathancooper.io/i-am-a-nerd/images/comment_gen_preview.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-07T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2020-03-07T00:00:00-06:00","headline":"How to Create an Automatic Code Comment Generator using Deep Learning!","image":"https://nathancooper.io/i-am-a-nerd/images/comment_gen_preview.png","description":"A tutorial for automatically generate code comments using Deep Learning.","mainEntityOfPage":{"@type":"WebPage","@id":"https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html"},"@type":"BlogPosting","url":"https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html","dateModified":"2020-03-07T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/i-am-a-nerd/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nathancooper.io/i-am-a-nerd/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/i-am-a-nerd/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>How to Create an Automatic Code Comment Generator using Deep Learning! | fastpages</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="How to Create an Automatic Code Comment Generator using Deep Learning!" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A tutorial for automatically generate code comments using Deep Learning." />
<meta property="og:description" content="A tutorial for automatically generate code comments using Deep Learning." />
<link rel="canonical" href="https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html" />
<meta property="og:url" content="https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:image" content="https://nathancooper.io/i-am-a-nerd/images/comment_gen_preview.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-07T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2020-03-07T00:00:00-06:00","headline":"How to Create an Automatic Code Comment Generator using Deep Learning!","image":"https://nathancooper.io/i-am-a-nerd/images/comment_gen_preview.png","description":"A tutorial for automatically generate code comments using Deep Learning.","mainEntityOfPage":{"@type":"WebPage","@id":"https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html"},"@type":"BlogPosting","url":"https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html","dateModified":"2020-03-07T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://nathancooper.io/i-am-a-nerd/feed.xml" title="fastpages" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    // remove paragraph tags in rendered toc (happens from notebooks)
    var toctags = document.querySelectorAll(".toc-entry")
    toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¶', '')))
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/i-am-a-nerd/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/i-am-a-nerd/about/">About Me</a><a class="page-link" href="/i-am-a-nerd/search/">Search</a><a class="page-link" href="/i-am-a-nerd/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to Create an Automatic Code Comment Generator using Deep Learning!</h1><p class="page-description">A tutorial for automatically generate code comments using Deep Learning.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-03-07T00:00:00-06:00" itemprop="datePublished">
        Mar 7, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      33 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/i-am-a-nerd/categories/#deep_learning">deep_learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/i-am-a-nerd/categories/#software_engineering">software_engineering</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/ncoop57/i-am-a-nerd/tree/master/_notebooks/2020-03-07-How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.ipynb" role="button">
<img class="notebook-badge-image" src="/i-am-a-nerd/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div><div class="px-2">
    <a href="https://colab.research.google.com/github/ncoop57/i-am-a-nerd/blob/master/_notebooks/2020-03-07-How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.ipynb">
        <img class="notebook-badge-image" src="/i-am-a-nerd/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#About">About </a></li>
<li class="toc-entry toc-h1"><a href="#Collecting,-preparing-and-exploring-the-data">Collecting, preparing and exploring the data </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Exploring-your-data!">Exploring your data! </a></li>
<li class="toc-entry toc-h2"><a href="#Loading-the-data-using-FastAI">Loading the data using FastAI </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Defining-your-model">Defining your model </a></li>
<li class="toc-entry toc-h1"><a href="#Evaluate-your-model">Evaluate your model </a></li>
<li class="toc-entry toc-h1"><a href="#Conclusion">Conclusion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-07-How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="About">
<a class="anchor" href="#About" aria-hidden="true"><span class="octicon octicon-link"></span></a>About<a class="anchor-link" href="#About"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this post, you will be create a Deep Learning model that given a piece of code, will automatically generate a comment describing (hopefully 🤞) what the piece of code does. This post will focus on Java code, however, the same approach should be able to be applied to other programming languages such as Python or Javascript.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Collecting,-preparing-and-exploring-the-data">
<a class="anchor" href="#Collecting,-preparing-and-exploring-the-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Collecting, preparing and exploring the data<a class="anchor-link" href="#Collecting,-preparing-and-exploring-the-data"> </a>
</h1>
<p>You will be using the <a href="https://github.blog/2019-09-26-introducing-the-codesearchnet-challenge/">CodeSearchNet Challenge</a> dataset from GitHub as it provides a large collection of clean code in multiple different languages. They have a really nice <a href="https://github.com/github/CodeSearchNet/blob/master/notebooks/ExploreData.ipynb">example</a> on how to download and read in the data in their repo that you'll use to get started.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> wget https://s3.amazonaws.com/code-search-net/CodeSearchNet/v2/java.zip
<span class="o">!</span> unzip java.zip
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--2020-03-07 16:37:37--  https://s3.amazonaws.com/code-search-net/CodeSearchNet/v2/java.zip
Resolving s3.amazonaws.com (s3.amazonaws.com)... 52.216.179.149
Connecting to s3.amazonaws.com (s3.amazonaws.com)|52.216.179.149|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1060569153 (1011M) [application/zip]
Saving to: ‘java.zip’

java.zip            100%[===================&gt;]   1011M  88.0MB/s    in 12s     

2020-03-07 16:37:49 (84.9 MB/s) - ‘java.zip’ saved [1060569153/1060569153]

Archive:  java.zip
   creating: java/
   creating: java/final/
   creating: java/final/jsonl/
   creating: java/final/jsonl/train/
  inflating: java/final/jsonl/train/java_train_12.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_9.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_3.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_5.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_7.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_1.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_10.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_14.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_0.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_6.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_8.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_15.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_2.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_4.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_13.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_11.jsonl.gz  
   creating: java/final/jsonl/test/
  inflating: java/final/jsonl/test/java_test_0.jsonl.gz  
   creating: java/final/jsonl/valid/
  inflating: java/final/jsonl/valid/java_valid_0.jsonl.gz  
  inflating: java_dedupe_definitions_v2.pkl  
  inflating: java_licenses.pkl       
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>jsonl_list_to_dataframe</code> method is directly from the CodeSearchNet Challenge example code and <code>get_dfs</code> is just a helper for you to properly grab the data into the correct training, validation, and testing splits. Let's see what your data looks like :D!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">jsonl_list_to_dataframe</span><span class="p">(</span><span class="n">file_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""Load a list of jsonl.gz files into a pandas DataFrame."""</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">f</span><span class="p">,</span>
                                   <span class="n">orient</span><span class="o">=</span><span class="s1">'records'</span><span class="p">,</span> 
                                   <span class="n">compression</span><span class="o">=</span><span class="s1">'gzip'</span><span class="p">,</span>
                                   <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">columns</span><span class="p">]</span> 
                      <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_dfs</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">"""Grabs the different data splits and converts them into dataframes"""</span>
    <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"train"</span><span class="p">,</span> <span class="s2">"valid"</span><span class="p">,</span> <span class="s2">"test"</span><span class="p">]:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">path</span><span class="o">/</span><span class="n">split</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"**/*.gz"</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">jsonl_list_to_dataframe</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="p">[</span><span class="s2">"code"</span><span class="p">,</span> <span class="s2">"docstring"</span><span class="p">])</span>
        <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">dfs</span>

<span class="n">df_trn</span><span class="p">,</span> <span class="n">df_val</span><span class="p">,</span> <span class="n">df_tst</span> <span class="o">=</span> <span class="n">get_dfs</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s2">"java/final/jsonl"</span><span class="p">)</span>
<span class="n">df_trn</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>docstring</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>protected final void bindIndexed(Configuration...</td>
      <td>Bind indexed elements to the supplied collecti...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>public void setServletRegistrationBeans(\n\t\t...</td>
      <td>Set {@link ServletRegistrationBean}s that the ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>public void addServletRegistrationBeans(\n\t\t...</td>
      <td>Add {@link ServletRegistrationBean}s for the f...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>public void setServletNames(Collection&lt;String&gt;...</td>
      <td>Set servlet names that the filter will be regi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>public void addServletNames(String... servletN...</td>
      <td>Add servlet names for the filter.\n@param serv...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You are going to only use a small subset of the data in order to train your model in a reasonable time. However, if you want to adjust the amount of data used you can just adjust the sample size.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">df_trn</span> <span class="o">=</span> <span class="n">df_trn</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="n">sample</span><span class="p">)</span>
<span class="n">df_val</span> <span class="o">=</span> <span class="n">df_val</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="n">sample</span><span class="p">)</span>
<span class="n">df_tst</span> <span class="o">=</span> <span class="n">df_tst</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="n">sample</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Awesome! Now that you have the data, there's a few other preprocessing steps you need to perform. First we are going to remove any non-english comments. Next, you will also remove the JavaDocs, i.e., any line with an @ symbol or curly braces, as that will significantlly lessen the amount of learning your model will have to do. This also works out well since the JavaDoc syntax can usually be autogenerated from the method's signature.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="c1"># From https://stackoverflow.com/a/27084708/5768407</span>
<span class="k">def</span> <span class="nf">isASCII</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'ascii'</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="n">df_trn</span> <span class="o">=</span> <span class="n">df_trn</span><span class="p">[</span><span class="n">df_trn</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">isASCII</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="n">df_val</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="n">df_val</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">isASCII</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
<span class="n">df_tst</span> <span class="o">=</span> <span class="n">df_tst</span><span class="p">[</span><span class="n">df_tst</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">isASCII</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">filter_jdocs</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">comments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">())):</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">"docstring"</span><span class="p">]</span>
        <span class="c1"># Remove {} text in comments from https://stackoverflow.com/questions/14596884/remove-text-between-and-in-python/14598135</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">"([\{\[]).*?([\)\}])"</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>
        
        
        <span class="n">cleaned</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">comment</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">"@"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
            <span class="n">cleaned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">comments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cleaned</span><span class="p">))</span>
        <span class="n">methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">"code"</span><span class="p">])</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">comments</span><span class="p">),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"code"</span><span class="p">,</span> <span class="s2">"docstring"</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">new_df</span>

<span class="n">df_trn</span> <span class="o">=</span> <span class="n">filter_jdocs</span><span class="p">(</span><span class="n">df_trn</span><span class="p">);</span>
<span class="n">df_val</span> <span class="o">=</span> <span class="n">filter_jdocs</span><span class="p">(</span><span class="n">df_val</span><span class="p">);</span>
<span class="n">df_tst</span> <span class="o">=</span> <span class="n">filter_jdocs</span><span class="p">(</span><span class="n">df_tst</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='88221' class='' max='88221', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [88221/88221 00:02&lt;00:00]
    </div>
    
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='2840' class='' max='2840', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [2840/2840 00:00&lt;00:00]
    </div>
    
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='5254' class='' max='5254', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [5254/5254 00:00&lt;00:00]
    </div>
    
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you are going to remove any empty comments or duplicate comments for your datasets.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_trn</span> <span class="o">=</span> <span class="n">df_trn</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df_trn</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">''</span><span class="p">)]</span>
<span class="n">df_val</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">''</span><span class="p">)]</span>
<span class="n">df_tst</span> <span class="o">=</span> <span class="n">df_tst</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df_tst</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">''</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_trn</span> <span class="o">=</span> <span class="n">df_trn</span><span class="p">[</span><span class="o">~</span><span class="n">df_trn</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">df_val</span> <span class="o">=</span> <span class="n">df_val</span><span class="p">[</span><span class="o">~</span><span class="n">df_val</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">df_tst</span> <span class="o">=</span> <span class="n">df_tst</span><span class="p">[</span><span class="o">~</span><span class="n">df_tst</span><span class="p">[</span><span class="s1">'docstring'</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Not bad, still leaves you with plenty of data to learn with!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_val</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_tst</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(73755, 2427, 4615)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploring-your-data!">
<a class="anchor" href="#Exploring-your-data!" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploring your data!<a class="anchor-link" href="#Exploring-your-data!"> </a>
</h2>
<p>As a good machine learning practitioner, it is extremely important to be careful with your data. This includes checking for biases, duplicates, and also describing the data that you have. Not doing so is setting you up for disaster. I have personally experienced such travesty when working on one of my own research projects where I forgot to check for duplicates before splitting my data. Sadly for me and all my restless nights working on the project, the data was full of duplicates and so my test set was contaminated with data points from my training set, which lead to inflated evaluation metrics :(.</p>
<p><strong>Always explore your data!</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You'll be doing some basic descriptive statistics for this Exploratory Data Analysis (EDA), which just means calculating some means, medians, and standard deviations for different views of your data. The first view you will be exploring is the tokens that make up your code and comments. To tokenize your data into these tokens you will use something called Byte Pair Encoding, which has shown great results for tokenizing both natural language and code as shown in Karampatsis and Sutton's paper <a href="https://arxiv.org/abs/1903.05734">"Maybe Deep Neural Networks are the Best Choice for Modeling Source Code."</a></p>
<p>A great resource on learning more about how Byte Pair Encoding works is this <a href="https://towardsdatascience.com/byte-pair-encoding-the-dark-horse-of-modern-nlp-eb36c7df4f10">blog post</a> by Akashdeep Singh Jaswal and this <a href="https://youtu.be/9oTHFx0Gg3Q">Youtube video</a> by Christopher Manning. Specifically, you will be using the awesome library by Google called <a href="https://github.com/google/sentencepiece">sentencepiece</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">df_to_txt_file</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="sd">"""Converts a dataframe and converts it into a text file that SentencePiece can use to train a BPE model"""</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="o">/</span><span class="s1">'text.txt'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">output</span><span class="o">/</span><span class="s1">'text.txt'</span>

<span class="k">def</span> <span class="nf">gen_sp_model</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">tokenizer_name</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="sd">"""Trains a SentencePiece BPE model from a pandas dataframe"""</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">df_to_txt_file</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="n">sp</span><span class="o">.</span><span class="n">SentencePieceTrainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="sa">f</span><span class="s1">'--input=</span><span class="si">{fname}</span><span class="s1"> --model_prefix={output / tokenizer_name} --hard_vocab_limit=false'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To use Byte Pair Encoding, you have to train the tokenizer on your data. However, no need to train your BPE on all of your data, so you will just be doing it on a subset (10%) of your training data. You are picking to train the BPE model from your training set to not perform any inadvertant data snooping by biasing your BPE model to tokenize more common words in your validation or testing set. This also will help show that you are indeed solving the out of vocabulary problem because you will most likely encounter words in your testing set that were not in your training set.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_bpe</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">method_tokenizer</span> <span class="o">=</span> <span class="s2">"method_bpe"</span>
<span class="n">gen_sp_model</span><span class="p">(</span><span class="n">df_trn</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="n">p_bpe</span><span class="p">),</span> <span class="n">path</span><span class="p">,</span> <span class="n">method_tokenizer</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">"code"</span><span class="p">)</span>
<span class="n">comment_tokenizer</span> <span class="o">=</span> <span class="s2">"comment_bpe"</span>
<span class="n">gen_sp_model</span><span class="p">(</span><span class="n">df_trn</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span> <span class="o">=</span> <span class="n">p_bpe</span><span class="p">),</span> <span class="n">path</span><span class="p">,</span> <span class="n">comment_tokenizer</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s2">"docstring"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that you have the ability to tokenize your text, let us explore! First you will just generate the frequency of each of your tokens and while you are at it, let's collect how long your methods are by via the common software metric Lines of Code (LOC).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">get_counter_and_lens</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">spm</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">toks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">())):</span>
        <span class="n">toks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">spm</span><span class="o">.</span><span class="n">EncodeAsPieces</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">]))</span>
        <span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)))</span>
            
    <span class="n">cnt</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">toks</span><span class="p">):</span>
        <span class="n">cnt</span><span class="p">[</span><span class="n">tok</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">toks</span><span class="p">)),</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">locs</span>

<span class="n">code_lens</span><span class="p">,</span> <span class="n">code_cnt</span><span class="p">,</span> <span class="n">locs</span> <span class="o">=</span> <span class="n">get_counter_and_lens</span><span class="p">(</span><span class="n">df_trn</span><span class="p">,</span> <span class="n">method_spm</span><span class="p">,</span> <span class="s1">'code'</span><span class="p">)</span>
<span class="n">comment_lens</span><span class="p">,</span> <span class="n">comment_cnt</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_counter_and_lens</span><span class="p">(</span><span class="n">df_trn</span><span class="p">,</span> <span class="n">method_spm</span><span class="p">,</span> <span class="s1">'docstring'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='73755' class='' max='73755', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [73755/73755 00:26&lt;00:00]
    </div>
    
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='12402148' class='' max='12402148', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [12402148/12402148 00:12&lt;00:00]
    </div>
    
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='73755' class='' max='73755', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [73755/73755 00:07&lt;00:00]
    </div>
    
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='2530502' class='' max='2530502', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [2530502/2530502 00:02&lt;00:00]
    </div>
    
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">plot_counts</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">top_k</span> <span class="o">=</span> <span class="mi">30</span><span class="p">):</span>
    <span class="n">labels</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">()[:</span><span class="n">top_k</span><span class="p">])</span>

    <span class="n">indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'w'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">indexes</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">indexes</span> <span class="o">+</span> <span class="n">width</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_counts</span><span class="p">(</span><span class="n">code_cnt</span><span class="p">,</span> <span class="n">top_k</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plot_counts</span><span class="p">(</span><span class="n">comment_cnt</span><span class="p">,</span> <span class="n">top_k</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A0KCEhISg1PG/ZlssFm3dujUoNYDOFBYWmvLD/He+8x3Nnj2728brze+Nly5dqrKyMpWVlWnNmjWS%0AOg8w2traAq8pwWaGfVt3P46uZgQYCJqGhga1trYqOjra6FYM069fP505c8boNkLuq6++0r/9278Z%0A3UbI2Gw2lZSUGNrDli1bNGHChJDV829zqL49MYM//vGP+u53v6uxY8ca9u3kI488YkhdP7vdri+/%0A/FI/+9nPtHnzZj366KNXPN5TTz2lO++8Uz6fTz/5yU80duxYjR8/XjU1NXrllVf08ccfy263a8eO%0AHYH6knTffffp6NGjKiws1PTp0zV58mQVFxfr9ttv1+OPP67vfve7eu655y66F6/Xq/vuu0/jx4/X%0AY489ptzcXBUXF8tms8lisWjjxo3629/+puLiYn3/+9/XU089dUXbfrG++OILDRgwQJK0e/duDRs2%0ALCh12r9mT5gwQVu2bJF09kPlzp07g1JTOvsYeOKJJ5Senq7HH39cknTmzBnNmDFDGRkZuvvuu9XU%0A1KTXX39dGzZs0OnTp3XNNdfo73//u9577z0tWLCg2+sXFhbqpZdekiS99dZbIX++Nzc3q6WlJaQ1%0A/datW6c77rgjcF/0ZHa7XT/5yU+Unp6un/3sZ5I6/9t++eWXuv/++zV8+HBt2LDhnHHcbrfmzJkj%0A6ew3+SNHjpTdbtf//u//XnJP7Z9n69at0+OPP6477rjjCrby4rW0tKi5uTmoNU6fPi2Px6PW1lbF%0Ax8fr9OnTKiws1DPPPKNZs2bJ7XZr8uTJmjJligoLCwP79MLCQt17772aPHmyRowYoc8//1yS9Itf%0A/EKjRo3ST3/6U91+++2X1VNn+7ZQa/84wpUhwEDQfPLJJxo8eLDRbRgqNjZWNTU1RrcRctXV1YqN%0AjQ1pzV/96ley2+3n/CxdujQktb/5zW/qo48+Ckmtzhw8eFDf/OY3Q1bPv82h+vbEDIqKirRgwQK9%0A++67mj9/viE9vPbaa4bUPd+yZcs0bdo0vfzyy1c81p133qlt27apqKhI8fHxevfdd7VkyRItXbpU%0As2fP1s033yy3262MjIxOx4iMjNSbb76p7OxsNTQ06Mknn5TH47mkDxhbtmzRTTfdpNLSUt16663y%0A+XwqKCjQ9u3bVV5erpdeekkpKSnKysrS//zP/2jZsmVXvO0Xo6SkRHfeeackqbi4WHfddVdQ6rR/%0AzW6/T8vNzdWoUaOCUtPvnnvuUVlZmaqqqtTY2KhVq1YpIyNDO3bs0AMPPKDXX39dNptN5eXlev/9%0A95WRkaHy8nKVl5crPT292+sb5S9/+YueeOIJZWRkGNZHSkqK+vXrp8TEREPqd7fJkyerrKxMX3zx%0Ahf70pz91ul5NTY1WrlypyspKLVu2TK2trRes09bWpmeeeUZbt26V2+2+rFkU7Z9nKSkpSkxMVL9+%0A/S55nMvR2NiojIwMPfHEE/rLX/4SlBrr16/Xiy++qBtvvFELFy5U3759lZubq1/+8pdat25doI/N%0AmzfroYceOud3Y2Nj9eabb+qhhx6Sy+XSsWPHVFJSIo/Ho8cff1z19fWX1VNn+7berqv3xUa+Z+4O%0AwZ9rDFzFbr31Vn388ceaPn36VXE4hXT2Q96DDz6oTZs2hbTuk08+qSeffDKkNXF1eeyxx7R48WKt%0AX79eDzzwgLKzs41uqVcYMWKEJOmjjz7S7373O5WVlcnn8yk5OfmCdcPCwgL/bn8cs38MSYqPj9eg%0AQYMk6ZJmAB4+fDgwu2HYsGHasmWLPvnkE2VmZko6+y3e8ePHL2HLuse2bdv04osvSjo7A2PevHkh%0A7yHYbrvtNknSf/zHf6ihoUEfffSRPvjgA61bt04tLS2y2WxKS0vTgQMHVFZWprlz52rDhg2qrq7W%0AE0880e31O3ucBUNLS4sKCwu1adMmDRo0SN///ve1fPnyoNY0m0WLFmnHjh06duyYoqOjFRcXp+99%0A73v60Y9+dMVj+5/TI0aM0KFDhzr9237jG98IHJqVnJysEydOXDDW8ePHlZycrJiYGElSeHjP+h44%0AMTFRFRUV8ng8euGFF/Tpp5/qvvvuU25uriIjI7ulxvDhw/Xb3/5Wzc3NysrK0sGDBztcp/3fwc//%0APExOTlZVVZWOHj2qoUOHKiwsTDfddJP69+/fLT1eLbp6X9zT3zMTYCBobrrpJh09etToNgy1d+9e%0ApaamhjS8qKmpUVJSUsjqnW/ixInavHmz1q1bJ7vdHrK6v/rVr1RUVHTOsqysLD399NNBr/3Xv/5V%0AQ4YMCXqdrtx8883661//GrJvzfzbXFtbq+uvv77DNyO9TWxsrF566SU1Nzdr2LBhhgQYRj+/g8H/%0AISAtLU0Oh0P//d//LUmBKfTtH1vx8fGqqanRjTfeeM43iO0/SFzuY/HGG2/Unj17dO+992rPnj1K%0ATExUWlqatm7dqqioKLW0tCgyMlKRkZEdfjsbDG1tbWpqalJcXJzq6uoUHx8ftA9N7V+z2+/T6urq%0AFB0dHdRvic//UJmWlqZRo0Zp5syZks4+FsLCwpSQkKDKykrNnz9fy5cv11dffdUtfZ1fPz4+XgcO%0AHJCkwMlTg+XkyZN69dVXdS2onNYAAASPSURBVPvtt2v27NmBD3FXk/nz52v+/PkqLCzU4MGDu/W9%0Aw549ezR+/Hjt3r1bdrtdtbW1Hf5tjx49qvr6evXr10/V1dUdvpZee+21qqmp0Zdffqn+/furra3t%0Akp+PZnhvbLFY1LdvX7388st69dVXde+993bbeXUOHTqk1NRURUVFKTY2Vj6f74J9Zmf32fnPw8GD%0AB2v//v3y+Xw6fPhw4PDBS9XZvq236+p9sZHvmbtDz4oOcVmOHTt2xceIXo64uDiFh4dfleeA8Gtq%0AalJKSkrI6nm9Xt1///0hq9eZlJSUkJ/g8cknn5Tb7T7nJ1Q74vLy8sAUb6Pcc8892rZtW8jq+bd5%0AxowZQT+m1ixee+01paeny263Kzc3N+T1zfL8DpbJkyfrn//8p8aOHauMjIzAdOObb75Z9957ryor%0AK/Xoo48qJydHDz74YOC8EN3lnnvu0cGDBzVu3Di9//77uuaaazRv3jxNmDBBY8eODUwXv+uuu5SX%0Al6clS5Z0a/2O7Nq1KzC7ZOvWrUE9z0371+xt27bpP//zPyVJy5cvD+o5MDryox/9SNu2bVNGRoYy%0AMjICJ90bPXp04PxK1113XdA+7I8fP14ej0fZ2dn69NNPg1LDLyEhQVVVVXr00Ue1evVqjR07VitW%0ArNBXX30V1LpXi3feeUfp6elKTEzUsGHDOv3bJicn66c//amsVqvmzJmjiIiIC8YKDw/XkiVLNG7c%0AOI0dO1br16+/5H6MfG/81VdfacWKFRo7dqxWr16tRx99VFVVVd16UuA5c+bIYrFo9OjRSktL05Ah%0AQ5SRkaHnn38+cB6Si3XddddpwoQJGjVqlFasWHHZfXa2b+vtunpfbOR75u4Q5uM6WQiioqIiHTt2%0ATD/4wQ9CUq/9JSRDcTWG82u2Fx4erjfffFNVVVVatGhRSHrZtWuX9u3bpx/+8IdBr9XVdh8/flwP%0APPBAt12h4GLrGjGds7q6Ws8//7xWrFgRknpdbf/999+v9evXB/2x79/m559/Xo899pheffXVoNbD%0AWWZ5fl/O88xsz9vO+GdZvP7666qvr1d+fn7Iand0H1VVVSkxMVE33HCDSkpKNHz4cP37v/970Hrw%0Av2Zv3bpVGzduVHh4uGbPnq0XX3zxivcrRj8GjK5/sc6cOaPNmzcrKysraFebkYy5P4JVs7NxMzIy%0A9Pbbb5vu0INQvzf2q6urU3FxsaZOnXrFJ9gP1ePHv0/+5JNPlJeXp7fffvuyxulo39Zb9JR9W7fy%0AAb2IpMBPKFRXV59Ts/3PkCFDfOnp6b49e/aEpJdQ6mq7FyxY4PP5fL5Zs2b5HA5HyOv2Zlf79vt8%0APl9DQ4NvzJgx5/zs3r3b6LZ6le5+nPWkx+1dd93ls9lsvvHjx/v++c9/hqxuT7qPLofR22d0fbMx%0A4v4IVs2uxh0zZozv5MmT3bcR8Pl8oX38PPPMM7709HTfiBEjfB988EG3jt0bXK37NmZgAAAAAAAA%0A0+ul80oAAAAAAEBvQoABAAAAAABMjwADAAAAAACYHgEGAAAAAAAwPQIMAAAAAABgev8PFLEHrpOd%0AoccAAAAASUVORK5CYII=%0A">
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0AJjY21jQ1NRljPPuYT0xMbHUf3759u3nppZfMihUrjDHG/PnPfzbPPvusx+q11Hz7/9hcyH7rQp3v%0AvtVTznUfb9lTTk6OWbZsmTHGmMGDB7er3tChQ83//d//mZMnT5q+ffuaQ4cOmVWrVpmXXnrJfPPN%0AN+45r1u3zrzwwgumqqrK3J254DUAAAj1SURBVHzzzaapqcl8/fXXJjEx0d138+uomJgY89VXX/1g%0AXsXFxcblcpkrr7zS7NixwzQ2Npobb7zRGGNMenq6+eyzz4wxxkybNs188skn7j6MMebQoUPm5z//%0AuWlsbDR79uwx48aNc/d/6j43LS3N7Nu3z7hcLhMbG2s2b97cruum+ba4GB53nfwdoODiN2jQIElS%0A7969VVNToz179qi0tFRJSUmSdFH9ZO6MGTP0n//5n1q3bp1+9atfKTU11Sd1e/TooeLiYpWWlurF%0AF1/UkSNHNGHCBGVmZio4ONgnPTT74x//qHXr1ikwMNBrnxKezubNm1VSUqJZs2YpPT1d3bp180nd%0Af/zjH4qMjPRJrbP57LPPFB0dLUmKjo7WgQMHlJCQ4OeuvMPlcqlHjx6SpGuuuUbHjh3zWe1BgwYp%0AICBA/fv39+n9+1S//e1v9dxzz+nbb7/VjBkzFBMT45U6jY2NWr16tdavX68+ffro7rvvdn+S5k1n%0A2o+c+nzy2WefafDgwZK+v99/9NFH511j7969SkxMdP99/Phx9e/fX5J044036uDBgz/YviS/PYe1%0AnPv27dt9UvNMj7Xm68JTunfvrj59+kiSunTpIkmtrvvm/3vanj179NZbb2nLli0yxig4OFgDBw50%0AP8Z99TzS7NT7d7Pg4GDNmDFDkydP1k9+8hMtWrTIo721vI8fOHBAe/bs0SeffKLXXntNjY2Nstvt%0AHqtlJTk5OXrnnXc0evTocx4y5UkXst+6UOe7b/WWU+t8/fXXuu+++3T06FFVV1e363shWnK5XAoP%0AD5ckXXfdda1O69q1qyIjI/U///M/Wr9+vV5++WUdPHhQn376qYYNGyZJ+vLLL3/Q65VXXqmvvvpK%0AoaGhrbY3cOBABQYG6vLLL9cNN9yggIAA92vuffv26Z577pEk1dfX6+abb/5Br9ddd506derU6jo/%0A3T73+PHjuvbaayV5b1/Y0XAICTwuODhYLpfL/XdAQID738YY9evXT4mJiSosLFRhYaE2bdrkjza9%0AIjQ0VC+//LJWrVqlrKwsn9ePi4vT9OnTFRkZqVdffVX19fU+7+Gll17S5s2b9cYbb3hsGeL5mDlz%0ApkpKStTU1KRx48YpMzPT6y/y9+/fr5///OderXE2LR9r11xzjfvYyk8++URRUVFer3/06FGv1zid%0AwMBAVVVVqbGxUQcOHNAVV1zhs9plZWUyxmj//v3q1auXz+qeqnfv3lq2bJkWL16suXPneq1OfX29%0AXn31VUVGRmr69OmKjY31Wq2WzrQfOfX55JprrtGOHTskSdu2bWtTjf79+2vLli3uvy+77DLt3btX%0Axhj993//t66++urTbt9fz2Gnzt0XzvRYCwz07MvHlnNr1vK6b/6/p/Xr108ZGRkqLCzUhx9+qFWr%0AVmnXrl3ux7i3v9zyXK+XmrlcLmVkZGjt2rXq2bOn3nzzTY/20fI+fs0116hfv3769a9/rcLCQpWU%0AlCg7O9uj9ZqdOn9fe/jhh1VYWOjT8ELSBe23LtT57ls95Vz38by8PF111VX68MMPlZmZ6a59un3C%0A+QgKClJNTY0aGhr06aef/uD0iRMnatmyZfrmm290xRVX6Gc/+5kGDhyozZs3q7CwUGVlZWfs9VQt%0ATz+132uvvVZr1qxRYWGhtm3bprS0tPN6vJ9un9uzZ08dOHDA/dwEiRUY8LixY8cqIyNDt95662lP%0AHzhwoKKiopSYmKjAwECNGjXK4y/Ajx8/rqVLl/r8y69+//vf680335TT6fTpt0p/9913Wrp0qTZs%0A2KABAwbo/vvvdyfHvhYfH6/4+HjFxMT4/NOrbt266Z577tE999yjvXv36u9//7tX623atEm33HKL%0AV2ucTcvHWlZWlu666y49+eSTuu6667y++sLpdOr2229XUVGRV+uczpNPPqnRo0crICBADzzwgE+/%0A5DA0NFRjxozRF198oRUrVvis7qkWLFigrVu3qqGhQTNnzvRanfDwcG3fvl07duzQihUr9Omnn+oX%0Av/iFpk+frksuucRrdc93P/LLX/5Sf/7znzVixIg2h4ljxozRpk2bFB8fr+DgYM2fP19Tp06VMUaj%0AR49W3759NWfOHN1xxx167rnnFBISIsk3z2FW4c/H2pw5c3T77bfr+eefV9euXb2ymnDMmDEqKCjQ%0AsGHDFBAQoF/96ldKTk5WbGysBg8erO7du3u8Zkvner3UrL6+Xr/4xS8UEBCggIAArVu3zqN9vPfe%0Ae1q4cKFuuOEGDR48WAMGDNC9996rVatWSZIeeeQRjR492qM1Jen666/XY489pvT0dP3hD39QWFiY%0Ax2tY0YXsty6Ur1+jnes+HhMToyeffFI7duxQz5493Star732Wt166616+OGHZbPZzrvewoULNWLE%0ACF111VW6/PLLf7DfuPnmmzVlyhQtXLhQ0vcrmG+77TYlJiYqKChI119/vf7rv/6rnbP9p8WLF2va%0AtGk6efKkgoKCtHLlSsXGxurOO+/U3/72Nz355JOnvdzp9rnZ2dm644479NOf/tTr+6SOIsD48iNS%0A+IzT6TzteGBgoMc+OfFFDZyf6upqbdq0SePHj3cvv/U2f93+VrrfTZgwQevWrfPqGznJWnNu9vHH%0AH6u8vFz//u//7rUaVpt3YWGh3n33XT333HNer2W1uTc7efKk3nzzTaWkpLiX6V4Iq87T1/xxPVj9%0Aunc6nerU6fvP2e644w49+OCDGjp0qJ+7ah8rXNdW6AG+4+vb2yr1XC6XLrnkEn333XeKjo7Wjh07%0ALugwv474uOmIPbfVxTELtHL06FEFBwef9r/mxLEj1MD5Cw8P1x133OGz8MJft7/V7nfjx4/3enhh%0AtTk3GzJkiFfDC6vO2xesPPcuXbrojjvu8Eh4YeV5+pI/roeOcN0fOXJEdrtdsbGxCgkJ6bDhhRWu%0Aayv0AN/x9e1tpXo33nijkpKSFBsbq1mzZl1QeNERHzcdsef2YAUGAAAAAACwPFZgAAAAAAAAyyPA%0AAAAAAAAAlkeAAQAAAAAALI8AAwAAAAAAWB4BBgAAAAAAsLz/Byf5uN9NkeDaAAAAAElFTkSuQmCC%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plotting your frequencies as a bar chart you start to see a nice picture of your data. Not that suprising, but the most common token happens to be the period and some other common syntactical tokens like curly braces and also key words like <em>if</em> and <em>return</em>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">plot_hist</span><span class="p">(</span><span class="n">lens</span><span class="p">,</span> <span class="n">n_bins</span> <span class="o">=</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lens</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">code_lens</span><span class="p">),</span> <span class="n">median</span><span class="p">(</span><span class="n">code_lens</span><span class="p">),</span> <span class="n">stdev</span><span class="p">(</span><span class="n">code_lens</span><span class="p">))</span>
<span class="n">plot_hist</span><span class="p">(</span><span class="n">code_lens</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">locs</span><span class="p">),</span> <span class="n">median</span><span class="p">(</span><span class="n">locs</span><span class="p">),</span> <span class="n">stdev</span><span class="p">(</span><span class="n">locs</span><span class="p">))</span>
<span class="n">plot_hist</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">comment_lens</span><span class="p">),</span> <span class="n">median</span><span class="p">(</span><span class="n">comment_lens</span><span class="p">),</span> <span class="n">stdev</span><span class="p">(</span><span class="n">comment_lens</span><span class="p">))</span>
<span class="n">plot_hist</span><span class="p">(</span><span class="n">comment_lens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3.4662519750610943 3.0 2.6490695431339177
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>18.54957629991187 10 50.99032748692644
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>3.57512896650546 3.0 2.605938655784157
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0ARwH1zAAAAABJRU5ErkJggg==%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, there are HTML elements left with &lt; and &gt; occurring quite often in your comments dataset that may make it harder for your model to learn to generate the comments that contain those elements. Luckily for us, it won't really affect your models accuracy, but exploring your data like this does allow us to see how your data may be influencing your model.</p>
<p><strong>TODO For You:</strong> Perform some further cleaning steps to remove HTML and any other cleaning you deem necessary and see how your performance changes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-the-data-using-FastAI">
<a class="anchor" href="#Loading-the-data-using-FastAI" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loading the data using FastAI<a class="anchor-link" href="#Loading-the-data-using-FastAI"> </a>
</h2>
<p>Now that you have the data processed and cleaned you need a way to get it into the format that FastAI uses. To do that you will use some code from Rachel Thomas' awesome <a href="https://github.com/fastai/course-nlp/blob/master/7-seq2seq-translation.ipynb">course on NLP</a>, which allows us to create a Sequence to Sequence (since you are going from the sequence of code to the sequence of the code's docstring) DataBunch (this is just the format FastAI uses for managing loading the data into memory for training and evaluating).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">seq2seq_collate</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">pad_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backwards</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="s2">"Function that collect samples and adds padding. Flips token order if needed"</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">to_data</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="n">max_len_x</span><span class="p">,</span><span class="n">max_len_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">]),</span><span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">])</span>
    <span class="n">res_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">max_len_x</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">()</span> <span class="o">+</span> <span class="n">pad_idx</span>
    <span class="n">res_y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">max_len_y</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">()</span> <span class="o">+</span> <span class="n">pad_idx</span>
    <span class="k">if</span> <span class="n">backwards</span><span class="p">:</span> <span class="n">pad_first</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">pad_first</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pad_first</span><span class="p">:</span> 
            <span class="n">res_x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]):],</span><span class="n">res_y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]):]</span> <span class="o">=</span> <span class="n">LongTensor</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>         
            <span class="n">res_x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span><span class="n">res_y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">LongTensor</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">LongTensor</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">backwards</span><span class="p">:</span> <span class="n">res_x</span><span class="p">,</span><span class="n">res_y</span> <span class="o">=</span> <span class="n">res_x</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">res_y</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res_x</span><span class="p">,</span> <span class="n">res_y</span>

<span class="k">class</span> <span class="nc">Seq2SeqDataBunch</span><span class="p">(</span><span class="n">TextDataBunch</span><span class="p">):</span>
    <span class="s2">"Create a `TextDataBunch` suitable for training an RNN classifier."</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">train_ds</span><span class="p">,</span> <span class="n">valid_ds</span><span class="p">,</span> <span class="n">test_ds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">val_bs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">dl_tfms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad_first</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">no_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">backwards</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">dl_kwargs</span><span class="p">):</span>
        <span class="s2">"Function that transform the `datasets` in a `DataBunch` for classification. Passes `**dl_kwargs` on to `DataLoader()`"</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_init_ds</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">valid_ds</span><span class="p">,</span> <span class="n">test_ds</span><span class="p">)</span>
        <span class="n">val_bs</span> <span class="o">=</span> <span class="n">ifnone</span><span class="p">(</span><span class="n">val_bs</span><span class="p">,</span> <span class="n">bs</span><span class="p">)</span>
        <span class="n">collate_fn</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">seq2seq_collate</span><span class="p">,</span> <span class="n">pad_idx</span><span class="o">=</span><span class="n">pad_idx</span><span class="p">,</span> <span class="n">pad_first</span><span class="o">=</span><span class="n">pad_first</span><span class="p">,</span> <span class="n">backwards</span><span class="o">=</span><span class="n">backwards</span><span class="p">)</span>
        <span class="n">train_sampler</span> <span class="o">=</span> <span class="n">SortishSampler</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">train_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">sampler</span><span class="o">=</span><span class="n">train_sampler</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">dl_kwargs</span><span class="p">)</span>
        <span class="n">dataloaders</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_dl</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">]</span>
            <span class="n">sampler</span> <span class="o">=</span> <span class="n">SortSampler</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">lengths</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)</span>
            <span class="n">dataloaders</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">val_bs</span><span class="p">,</span> <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span> <span class="o">**</span><span class="n">dl_kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">dataloaders</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">collate_fn</span><span class="o">=</span><span class="n">collate_fn</span><span class="p">,</span> <span class="n">no_check</span><span class="o">=</span><span class="n">no_check</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Seq2SeqTextList</span><span class="p">(</span><span class="n">TextList</span><span class="p">):</span>
    <span class="n">_bunch</span> <span class="o">=</span> <span class="n">Seq2SeqDataBunch</span>
    <span class="n">_label_cls</span> <span class="o">=</span> <span class="n">TextList</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is where you are telling FastAI to use your trained BPE models for tokenizing your data. FastAI's tokenizers will also do some additional processing of your text such as lower casing all words, removing repetitions, etc. You can find a full list of the processing FastAI uses <a href="https://docs.fast.ai/text.transform.html#Tokenizer">here</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">method_processor</span> <span class="o">=</span> <span class="n">SPProcessor</span><span class="p">(</span>
    <span class="n">sp_model</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="p">(</span><span class="n">method_tokenizer</span> <span class="o">+</span> <span class="s2">".model"</span><span class="p">),</span>
    <span class="n">sp_vocab</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="p">(</span><span class="n">method_tokenizer</span> <span class="o">+</span> <span class="s2">".vocab"</span><span class="p">),</span>
    <span class="n">include_eos</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">comment_processor</span> <span class="o">=</span> <span class="n">SPProcessor</span><span class="p">(</span>
    <span class="n">sp_model</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="p">(</span><span class="n">comment_tokenizer</span> <span class="o">+</span> <span class="s2">".model"</span><span class="p">),</span>
    <span class="n">sp_vocab</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="p">(</span><span class="n">comment_tokenizer</span> <span class="o">+</span> <span class="s2">".vocab"</span><span class="p">),</span>
    <span class="n">include_eos</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that you have your BPE model you will generate the DataBunches suitable for your task, which will be the Seq2Seq DataBunch. You will also filter out sequences that your too long so that you can fit everything onto a Google Colab GPU and to not have your training take too long.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">gen_dbs</span><span class="p">(</span><span class="n">df_trn</span><span class="p">,</span> <span class="n">df_val</span><span class="p">,</span> <span class="n">df_tst</span><span class="p">,</span> <span class="n">method_processor</span><span class="p">,</span> <span class="n">comment_processor</span><span class="p">,</span> <span class="n">bs</span> <span class="o">=</span> <span class="mi">96</span><span class="p">,</span> <span class="n">max_seq</span> <span class="o">=</span> <span class="mi">128</span><span class="p">):</span>
    <span class="n">is_valid</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_trn</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_val</span><span class="p">)</span>
    <span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_trn</span><span class="p">,</span> <span class="n">df_val</span><span class="p">])</span>
    <span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">df_merged</span><span class="p">[</span><span class="s2">"code"</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="n">df_merged</span><span class="p">[</span><span class="s2">"docstring"</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="n">is_valid</span><span class="p">),</span>
                                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"code"</span><span class="p">,</span> <span class="s2">"docstring"</span><span class="p">,</span> <span class="s2">"valid"</span><span class="p">]</span>
    <span class="p">)</span>
                             
    <span class="n">db_trn</span> <span class="o">=</span> <span class="p">(</span><span class="n">Seq2SeqTextList</span>
              <span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df_merged</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="s1">'code'</span><span class="p">,</span> <span class="n">processor</span> <span class="o">=</span> <span class="n">method_processor</span><span class="p">)</span>
              <span class="o">.</span><span class="n">split_from_df</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">'valid'</span><span class="p">)</span>
              <span class="o">.</span><span class="n">label_from_df</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="s1">'docstring'</span><span class="p">,</span> <span class="n">label_cls</span><span class="o">=</span><span class="n">TextList</span><span class="p">,</span> <span class="n">processor</span> <span class="o">=</span> <span class="n">comment_processor</span><span class="p">)</span>
              <span class="o">.</span><span class="n">filter_by_func</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_seq</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_seq</span><span class="p">)</span>
              <span class="o">.</span><span class="n">databunch</span><span class="p">(</span><span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span><span class="p">))</span>
    
    <span class="n">db_tst</span> <span class="o">=</span> <span class="p">(</span><span class="n">Seq2SeqTextList</span>
              <span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df_tst</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="s1">'code'</span><span class="p">,</span> <span class="n">processor</span> <span class="o">=</span> <span class="n">method_processor</span><span class="p">)</span>
              <span class="o">.</span><span class="n">split_by_rand_pct</span><span class="p">(</span><span class="n">valid_pct</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
              <span class="o">.</span><span class="n">label_from_df</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="s1">'docstring'</span><span class="p">,</span> <span class="n">label_cls</span><span class="o">=</span><span class="n">TextList</span><span class="p">,</span> <span class="n">processor</span> <span class="o">=</span> <span class="n">comment_processor</span><span class="p">)</span>
              <span class="o">.</span><span class="n">filter_by_func</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_seq</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_seq</span><span class="p">)</span>
              <span class="o">.</span><span class="n">databunch</span><span class="p">(</span><span class="n">bs</span> <span class="o">=</span> <span class="mi">16</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">db_trn</span><span class="p">,</span> <span class="n">db_tst</span>

<span class="n">db_trn</span><span class="p">,</span> <span class="n">db_tst</span> <span class="o">=</span> <span class="n">gen_dbs</span><span class="p">(</span><span class="n">df_trn</span><span class="p">,</span> <span class="n">df_val</span><span class="p">,</span> <span class="n">df_tst</span><span class="p">,</span> <span class="n">method_processor</span><span class="p">,</span> <span class="n">comment_processor</span><span class="p">,</span> <span class="n">bs</span> <span class="o">=</span> <span class="mi">96</span><span class="p">,</span> <span class="n">max_seq</span> <span class="o">=</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">db_trn</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>text</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>▁ xx b os ▁boolean ▁res er ve ( int ▁column , ▁int ▁size ) ▁{ ▁if ▁( ( column ▁&lt; ▁0) ▁|| ▁( ( column ▁+ ▁size ) ▁&gt; ▁columns )) ▁throw ▁new ▁index out of bound s exception (" res er ve ▁- ▁ inc or rec t ▁column ▁/ ▁size "); ▁for ( int ▁i = column ; ▁i ▁&lt; ▁column ▁+ ▁size ; ▁i ++) ▁{</td>
      <td>▁ xx b os ▁ xx ma j ▁re s er ve s ▁a ▁&lt; code &gt; ce ll &lt; ▁/ ▁ xx up ▁code &gt; ▁in ▁the ▁&lt; code &gt; ro w &lt; ▁/ ▁ xx up ▁code &gt; . ▁ xx e os</td>
    </tr>
    <tr>
      <td>▁ xx b os ▁@ help ( ▁ help ▁= ▁" get ▁all ▁the ▁ virtual network function descriptor ▁ xx m a j ▁dependency ▁of ▁a ▁network service descriptor ▁with ▁specific ▁id " ▁) ▁public ▁list &lt; v n f d ep end en cy &gt; ▁get v n f dependencies ( final ▁ xx m a j ▁string ▁id ns d ) ▁throws ▁s d k exception ▁{</td>
      <td>▁ xx b os ▁ xx ma j ▁return ▁a ▁ xx ma j ▁list ▁with ▁all ▁the ▁v n f de p end en c ies ▁that ▁are ▁contain ed ▁in ▁a ▁specific ▁network service descriptor . ▁ xx e os</td>
    </tr>
    <tr>
      <td>▁ xx b os ▁@ override ▁public ▁void ▁delete as set and attachment s ( final ▁ xx m a j ▁string ▁as set id ) ▁throws ▁ io exception , ▁request failure exception ▁{ ▁ xx m a j ▁as set ▁as s ▁= ▁get un v er ified as set ( as set id ); ▁list &lt; attachment &gt; ▁attachment s ▁= ▁as s . get attachment s</td>
      <td>▁ xx b os ▁ xx ma j ▁this ▁will ▁delete ▁an ▁asset ▁and ▁all ▁its ▁attachments ▁ xx e os</td>
    </tr>
    <tr>
      <td>▁ xx b os ▁public ▁list &lt; character book mark fold er s response &gt; ▁get character s character id book mark s fold er s ( integer ▁character id , ▁ xx m a j ▁string ▁data source , ▁ xx m a j ▁string ▁if n one match , ▁ xx m a j ▁ integer ▁page , ▁ xx m a j ▁string ▁token ) ▁throws ▁api</td>
      <td>▁ xx b os ▁ xx ma j ▁list ▁ bookmark ▁folders ▁a ▁list ▁of ▁your ▁character &amp; ' s ▁personal ▁ bookmark ▁folders ▁--- ▁ xx ma j ▁this ▁route ▁is ▁cached ▁for ▁up ▁to ▁36 00 ▁seconds ▁ xx up ▁ s so ▁ xx ma j ▁scope : ▁ esi - bookmark s . read _ character _ bookmark s . v 1 ▁ xx e os</td>
    </tr>
    <tr>
      <td>▁ xx b os ▁@ de pre c ated ▁protected ▁final ▁map &lt; db id , ▁k n n list &gt; ▁batch n n ( n ▁node , ▁db id s ▁ids , ▁int ▁k max ) ▁{ ▁map &lt; db id , ▁k n n list &gt; ▁res ▁= ▁new ▁hash map &lt;&gt;( id s . size ()); ▁for ( db id iter ▁iter ▁= ▁ids . iter ();</td>
      <td>▁ xx b os ▁ xx ma j ▁perform s ▁a ▁batch ▁k - ne a rest ▁neighbor ▁query ▁for ▁a ▁list ▁of ▁query ▁objects . ▁ xx e os</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">shift_tfm</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">b</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">y</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># Add the necessary shift transformation for training your Transformer model</span>
<span class="n">db_trn</span><span class="o">.</span><span class="n">add_tfm</span><span class="p">(</span><span class="n">shift_tfm</span><span class="p">)</span>
<span class="n">db_tst</span><span class="o">.</span><span class="n">add_tfm</span><span class="p">(</span><span class="n">shift_tfm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Defining-your-model">
<a class="anchor" href="#Defining-your-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Defining your model<a class="anchor-link" href="#Defining-your-model"> </a>
</h1>
<p>In this example, you will be using the Transformer architecture that was developed by <a href="https://arxiv.org/abs/1706.03762">Vaswani et. al.</a>. If you want a better understanding of this model, I highly suggest <a href="http://nlp.seas.harvard.edu/2018/04/03/attention.html#applications-of-attention-in-our-model">The Annotated Transformer</a> blog post and the <a href="https://www.youtube.com/playlist?list=PLtmWHNX-gukKocXQOkQjuVxglSDYWsSh9">NLP course</a> by Rachel Thomas, which this model code is copied from.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="k">class</span> <span class="nc">PositionalEncoding</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="s2">"Encode the position with a sinusoid."</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="s1">'freq'</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10000</span> <span class="o">**</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span><span class="o">/</span><span class="n">d</span><span class="p">)))</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ger</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">inp</span><span class="o">.</span><span class="n">sin</span><span class="p">(),</span> <span class="n">inp</span><span class="o">.</span><span class="n">cos</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">enc</span>

<span class="k">class</span> <span class="nc">TransformerEmbedding</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="s2">"Embedding + positional encoding + dropout"</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocab_sz</span><span class="p">,</span> <span class="n">emb_sz</span><span class="p">,</span> <span class="n">inp_p</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emb_sz</span> <span class="o">=</span> <span class="n">emb_sz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embed</span> <span class="o">=</span> <span class="n">embedding</span><span class="p">(</span><span class="n">vocab_sz</span><span class="p">,</span> <span class="n">emb_sz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_enc</span> <span class="o">=</span> <span class="n">PositionalEncoding</span><span class="p">(</span><span class="n">emb_sz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drop</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">inp_p</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">):</span> 
        <span class="n">pos</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inp</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">inp</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">emb_sz</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_enc</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">feed_forward</span><span class="p">(</span><span class="n">d_model</span><span class="p">,</span> <span class="n">d_ff</span><span class="p">,</span> <span class="n">ff_p</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">double_drop</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">d_model</span><span class="p">,</span> <span class="n">d_ff</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">double_drop</span><span class="p">:</span> <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">ff_p</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">SequentialEx</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">d_ff</span><span class="p">,</span> <span class="n">d_model</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">ff_p</span><span class="p">),</span> <span class="n">MergeLayer</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">d_model</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">MultiHeadAttention</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">d_head</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">d_head</span> <span class="o">=</span> <span class="n">ifnone</span><span class="p">(</span><span class="n">d_head</span><span class="p">,</span> <span class="n">d_model</span><span class="o">//</span><span class="n">n_heads</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_heads</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">d_head</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">n_heads</span><span class="p">,</span><span class="n">d_head</span><span class="p">,</span><span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_wgt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">k_wgt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">v_wgt</span> <span class="o">=</span> <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
            <span class="n">d_model</span><span class="p">,</span> <span class="n">n_heads</span> <span class="o">*</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">n_heads</span> <span class="o">*</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drop_att</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">drop_res</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ln</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">d_model</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">kv</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ln</span><span class="p">(</span><span class="n">q</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_res</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_apply_attention</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">kv</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">))))</span>
    
    <span class="k">def</span> <span class="nf">create_attn_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">bs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_heads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d_head</span>
                            <span class="p">)</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_apply_attention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">kv</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">bs</span><span class="p">,</span><span class="n">seq_len</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">q</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">wq</span><span class="p">,</span><span class="n">wk</span><span class="p">,</span><span class="n">wv</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_attn_mat</span><span class="p">(</span><span class="o">*</span><span class="n">o</span><span class="p">,</span><span class="n">bs</span><span class="p">),</span>
                       <span class="nb">zip</span><span class="p">((</span><span class="n">q</span><span class="p">,</span><span class="n">kv</span><span class="p">,</span><span class="n">kv</span><span class="p">),(</span><span class="bp">self</span><span class="o">.</span><span class="n">q_wgt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">k_wgt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">v_wgt</span><span class="p">)))</span>
        <span class="n">attn_score</span> <span class="o">=</span> <span class="n">wq</span> <span class="o">@</span> <span class="n">wk</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">:</span> <span class="n">attn_score</span> <span class="o">/=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_head</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">attn_score</span> <span class="o">=</span> <span class="n">attn_score</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">masked_fill</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">'inf'</span><span class="p">))</span><span class="o">.</span><span class="n">type_as</span><span class="p">(</span><span class="n">attn_score</span><span class="p">)</span>
        <span class="n">attn_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_att</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">attn_score</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">attn_vec</span> <span class="o">=</span> <span class="n">attn_prob</span> <span class="o">@</span> <span class="n">wv</span>
        <span class="k">return</span> <span class="n">attn_vec</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">contiguous</span><span class="p">()</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_output_mask</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">pad_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">new_ones</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">inp</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">diagonal</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span><span class="o">.</span><span class="n">byte</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">EncoderBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="s2">"Encoder block of a Transformer model."</span>
    <span class="c1">#Can't use Sequential directly cause more than one input...</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">d_inner</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">double_drop</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mha</span> <span class="o">=</span> <span class="n">MultiHeadAttention</span><span class="p">(</span><span class="n">n_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff</span>  <span class="o">=</span> <span class="n">feed_forward</span><span class="p">(</span><span class="n">d_model</span><span class="p">,</span> <span class="n">d_inner</span><span class="p">,</span> <span class="n">ff_p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">double_drop</span><span class="o">=</span><span class="n">double_drop</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mha</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">DecoderBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="s2">"Decoder block of a Transformer model."</span>
    <span class="c1">#Can't use Sequential directly cause more than one input...</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">d_inner</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">double_drop</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mha1</span> <span class="o">=</span> <span class="n">MultiHeadAttention</span><span class="p">(</span><span class="n">n_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mha2</span> <span class="o">=</span> <span class="n">MultiHeadAttention</span><span class="p">(</span><span class="n">n_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ff</span>   <span class="o">=</span> <span class="n">feed_forward</span><span class="p">(</span><span class="n">d_model</span><span class="p">,</span> <span class="n">d_inner</span><span class="p">,</span> <span class="n">ff_p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">double_drop</span><span class="o">=</span><span class="n">double_drop</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">enc</span><span class="p">,</span> <span class="n">mask_out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mha2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mha1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mask_out</span><span class="p">),</span> <span class="n">enc</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">class</span> <span class="nc">Transformer</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp_vsz</span><span class="p">,</span> <span class="n">out_vsz</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">n_heads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">d_head</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> 
                 <span class="n">d_inner</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">double_drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enc_emb</span> <span class="o">=</span> <span class="n">TransformerEmbedding</span><span class="p">(</span><span class="n">inp_vsz</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dec_emb</span> <span class="o">=</span> <span class="n">TransformerEmbedding</span><span class="p">(</span><span class="n">out_vsz</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">d_head</span><span class="p">,</span> <span class="n">d_inner</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">bias</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">double_drop</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">([</span><span class="n">EncoderBlock</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_layers</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">([</span><span class="n">DecoderBlock</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_layers</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">d_model</span><span class="p">,</span> <span class="n">out_vsz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec_emb</span><span class="o">.</span><span class="n">embed</span><span class="o">.</span><span class="n">weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad_idx</span> <span class="o">=</span> <span class="n">pad_idx</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
        <span class="n">mask_out</span> <span class="o">=</span> <span class="n">get_output_mask</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_idx</span><span class="p">)</span>
        <span class="n">enc</span><span class="p">,</span><span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enc_emb</span><span class="p">(</span><span class="n">inp</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">dec_emb</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">)(</span><span class="n">enc</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">)(</span><span class="n">out</span><span class="p">,</span> <span class="n">enc</span><span class="p">,</span> <span class="n">mask_out</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To evaluate your model you will be using the commonly used BLEU score, which is a measure for determining how closely your model's generated comment is to the real comment of a method. (This code is also copied from the NLP tutorial from Rachel Thomas)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse</span>
<span class="k">class</span> <span class="nc">NGram</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ngram</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngram</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">max_n</span> <span class="o">=</span> <span class="n">ngram</span><span class="p">,</span><span class="n">max_n</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngram</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ngram</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngram</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ngram</span><span class="p">))</span>
    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">o</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_n</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngram</span><span class="p">)]))</span>

<span class="k">def</span> <span class="nf">get_grams</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="p">[</span><span class="n">NGram</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">],</span> <span class="n">max_n</span><span class="o">=</span><span class="n">max_n</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">get_correct_ngrams</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">targ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">pred_grams</span><span class="p">,</span><span class="n">targ_grams</span> <span class="o">=</span> <span class="n">get_grams</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="n">max_n</span><span class="p">),</span><span class="n">get_grams</span><span class="p">(</span><span class="n">targ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="n">max_n</span><span class="p">)</span>
    <span class="n">pred_cnt</span><span class="p">,</span><span class="n">targ_cnt</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">pred_grams</span><span class="p">),</span><span class="n">Counter</span><span class="p">(</span><span class="n">targ_grams</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">targ_cnt</span><span class="p">[</span><span class="n">g</span><span class="p">])</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">pred_cnt</span><span class="o">.</span><span class="n">items</span><span class="p">()]),</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_grams</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">CorpusBLEU</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocab_sz</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab_sz</span> <span class="o">=</span> <span class="n">vocab_sz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'bleu'</span>
    
    <span class="k">def</span> <span class="nf">on_epoch_begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">targ_len</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">corrects</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
    
    <span class="k">def</span> <span class="nf">on_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last_output</span><span class="p">,</span> <span class="n">last_target</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">last_output</span> <span class="o">=</span> <span class="n">last_output</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pred</span><span class="p">,</span><span class="n">targ</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">last_output</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span><span class="n">last_target</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">targ_len</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">targ</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">c</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">get_correct_ngrams</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">targ</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab_sz</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corrects</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">+=</span> <span class="n">t</span>
    
    <span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">last_metrics</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">precs</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">/</span><span class="n">t</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corrects</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)]</span>
        <span class="n">len_penalty</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">targ_len</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pred_len</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">targ_len</span> <span class="k">else</span> <span class="mi">1</span>
        <span class="n">bleu</span> <span class="o">=</span> <span class="n">len_penalty</span> <span class="o">*</span> <span class="p">((</span><span class="n">precs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">precs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">precs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">precs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">**</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">add_metrics</span><span class="p">(</span><span class="n">last_metrics</span><span class="p">,</span> <span class="n">bleu</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_x_vocab</span><span class="p">,</span> <span class="n">n_y_vocab</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">db_trn</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">db_trn</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">itos</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Transformer</span><span class="p">(</span><span class="n">n_x_vocab</span><span class="p">,</span> <span class="n">n_y_vocab</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">db_trn</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">CorpusBLEU</span><span class="p">(</span><span class="n">n_y_vocab</span><span class="p">)],</span> <span class="n">loss_func</span> <span class="o">=</span> <span class="n">CrossEntropyFlat</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you are going to use the awesome Learning Rate finder provided by FastAI, which is based on the awesome paper from Leslie N. Smith <a href="https://arxiv.org/abs/1506.01186">"Cyclical Learning Rates for Training Neural Networks"</a>. This way you don't have to do a bunch of hyperparameter searching to find the perfect fit.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
<span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">suggestion</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='0' class='' max='1', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      0.00% [0/1 00:00&lt;00:00]
    </div>
    
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>bleu</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>

    </p>
<div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='92' class='' max='423', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      21.75% [92/423 01:21&lt;04:53 19.5654]
    </div>
    
&lt;/div&gt;

&lt;/div&gt;

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LR Finder is complete, type {learner_name}.recorder.plot() to see the graph.
Min numerical gradient: 3.02E-03
Min loss divided by 10: 1.74E-02
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0AQmCC%0A">
</div>

</div>

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is common to pick a point a bit before the suggested point.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">max_lr</span> <span class="o">=</span> <span class="mf">5e-4</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>DRUM ROLL PLEASE!!!!!</strong> You are now going to finally start training your model! Specifically for 8 epochs because that was what was in the original code in the NLP course and it also happened to work the best during my training. However, you are also implementing a few call backs, namely automatically saving the best performing model, early stopping, and showing the training and validation loss graph. Since you are using early stopping, feel free to try out a higher epoch number and the training will stop once it starts not improving.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">max_lr</span> <span class="o">=</span> <span class="mf">5e-4</span><span class="p">):</span>
    <span class="sd">"""Trains a model using save model, early stopping, and show graph call backs."""</span>
    <span class="n">callback_fns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">callbacks</span><span class="o">.</span><span class="n">SaveModelCallback</span><span class="p">(</span>
            <span class="n">learn</span><span class="p">,</span> <span class="n">every</span><span class="o">=</span><span class="s1">'improvement'</span><span class="p">,</span>
            <span class="n">monitor</span><span class="o">=</span><span class="s1">'valid_loss'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">'</span><span class="si">{model_name}</span><span class="s1">_save_model'</span>
        <span class="p">),</span>
        <span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStoppingCallback</span><span class="p">(</span>
            <span class="n">learn</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s1">'valid_loss'</span><span class="p">,</span> <span class="n">min_delta</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
            <span class="n">patience</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="p">),</span>
        <span class="n">ShowGraph</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
    <span class="p">]</span>
    
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">max_lr</span><span class="p">,</span> <span class="n">div_factor</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callback_fns</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s1">'comment_gen'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Training on Google Colab can take anywhere from ~20 to 60 minutes depending on the type of GPU they give you. So, relax, get an IV caffeine drip going, and let your model cook in peace :).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_model</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">max_lr</span> <span class="o">=</span> <span class="n">max_lr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>bleu</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.182219</td>
      <td>1.133453</td>
      <td>0.828182</td>
      <td>0.791774</td>
      <td>06:46</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.920205</td>
      <td>0.954264</td>
      <td>0.841556</td>
      <td>0.799681</td>
      <td>06:47</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.812330</td>
      <td>0.875513</td>
      <td>0.849487</td>
      <td>0.804000</td>
      <td>06:44</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.752023</td>
      <td>0.828835</td>
      <td>0.853668</td>
      <td>0.807183</td>
      <td>06:45</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.679716</td>
      <td>0.794862</td>
      <td>0.856593</td>
      <td>0.809325</td>
      <td>06:43</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.653454</td>
      <td>0.777795</td>
      <td>0.859418</td>
      <td>0.811010</td>
      <td>06:42</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.611860</td>
      <td>0.770059</td>
      <td>0.860419</td>
      <td>0.812164</td>
      <td>06:49</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.605370</td>
      <td>0.769881</td>
      <td>0.860601</td>
      <td>0.812119</td>
      <td>06:45</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Better model found at epoch 0 with valid_loss value: 1.133453130722046.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Better model found at epoch 1 with valid_loss value: 0.9542644023895264.
Better model found at epoch 2 with valid_loss value: 0.8755126595497131.
Better model found at epoch 3 with valid_loss value: 0.8288350701332092.
Better model found at epoch 4 with valid_loss value: 0.7948615550994873.
Better model found at epoch 5 with valid_loss value: 0.7777946591377258.
Better model found at epoch 6 with valid_loss value: 0.7700592279434204.
Better model found at epoch 7 with valid_loss value: 0.7698812484741211.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Evaluate-your-model">
<a class="anchor" href="#Evaluate-your-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluate your model<a class="anchor-link" href="#Evaluate-your-model"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us now evaluated your trained model on some of your validation set so see how well your model is generating comments.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">get_predictions</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">ds_type</span><span class="o">=</span><span class="n">DatasetType</span><span class="o">.</span><span class="n">Valid</span><span class="p">):</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="p">[],[],[]</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="ow">in</span> <span class="n">progress_bar</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">dl</span><span class="p">(</span><span class="n">ds_type</span><span class="p">)):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="n">xb</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">out</span><span class="p">):</span>
                <span class="n">inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">cpu</span><span class="p">()))</span>
                <span class="n">targets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">cpu</span><span class="p">()))</span>
                <span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span>

<span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">get_predictions</span><span class="p">(</span><span class="n">learn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='16' class='' max='16', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      100.00% [16/16 00:08&lt;00:00]
    </div>
    
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">print_results</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">method_spm</span><span class="p">,</span> <span class="n">comment_spm</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="sd">"""Just a little helper function for printing out the results from your model."""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Input:"</span><span class="p">,</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decode_spec_tokens</span><span class="p">(</span><span class="n">method_spm</span><span class="o">.</span><span class="n">DecodePieces</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">))),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Target:"</span><span class="p">,</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decode_spec_tokens</span><span class="p">(</span><span class="n">comment_spm</span><span class="o">.</span><span class="n">DecodePieces</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">targets</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">))),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Predicted:"</span><span class="p">,</span> <span class="s2">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">decode_spec_tokens</span><span class="p">(</span><span class="n">comment_spm</span><span class="o">.</span><span class="n">DecodePieces</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">outputs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">))),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        
<span class="n">print_results</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">method_spm</span><span class="p">,</span> <span class="n">comment_spm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Input: xxbos @doesservicerequest private void putrangeinternal(final filerange range, final filerangeoperationtype operationtype, final byte[] data, final long length, final String md5, final accesscondition accesscondition, final filerequestoptions options, final operationcontext opcontext) throws storageexception { executionengine.executewithretry(this.fileserviceclient, this, putrangeimpl(range, operationtype, data, length, md5, accesscondition, options, opcontext), options.getretrypolicyfactory(), opcontext); } xxeos 

Target: xxbos Used for both uploadrange and clearrange. xxeos 

Predicted: xxbos Put to creating thes( s( xxeos 

Input: xxbos public static byte[] encodesequence(byte[]... encodedvalues) { int length = 0; for (byte[] encodedvalue : encodedvalues) { length += encodedvalue.length; } byte[] lengthencoded = encodelength(length); bytearraydataoutput out = bytestreams.newdataoutput(1 + lengthencoded.length + length); out.write(sequence_tag); out.write(lengthencoded); for (byte[] entry : encodedvalues) { out.write(entry); } return out.tobytearray(); } xxeos 

Target: xxbos Encodes a sequence of encoded values. xxeos 

Predicted: xxbos Encodes a byte of bytes bytes into xxeos 

Input: xxbos @override public String dnsresolveex(string host) { stringbuilder result = new stringbuilder(); try { inetaddress[] list = inetaddress.getallbyname(host); for (inetaddress inetaddress : list) { result.append(inetaddress.gethostaddress()); result.append("; "); } } catch (unknownhostexception e) { log.log(level.fine, "DNS name not resolvable {0}.", host); } return result.tostring(); } xxeos 

Target: xxbos *********************************************************************** dnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveex xxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeos 

Predicted: xxbos xxmap 51 * namepp  =pxxeos 

Input: xxbos protected void removeallfromattributevalueset() { final collection&lt;abstracthtml5sharedobject&gt; sharedobjects = getsharedobjects(); boolean listenerinvoked = false; final collection&lt;writelock&gt; writelocks = lockandgetwritelocks(); try { getattributevalueset().clear(); setmodified(true); invokevaluechangelisteners(sharedobjects); listenerinvoked = true; } finally { for (final Lock lock : writelocks) { lock.unlock(); } } pushqueues(sharedobjects, listenerinvoked); } xxeos 

Target: xxbos clears all values from the value set. xxeos 

Predicted: xxbos s all attribute from the    xxeos 

Input: xxbos public void registercheckwithnotes(string checkid, String name, String script, long interval, @suppresswarnings("sameparametervalue") String notes) { Check check = new Check(); check.setid(checkid); check.setname(name); check.setscript(script); check.setinterval(string.format(" ⁇ ss", interval)); check.setnotes(notes); registercheck(check); } xxeos 

Target: xxbos Registers a Health Check with the Agent. xxeos 

Predicted: xxbos Registers a xxupj ealth checkxxmaj  check a givenxxmaj  name xxeos 

Input: xxbos public void assertequalsignoringcase(@nullable Description description, @nullable String actual, @nullable String expected) { if (!areequalignoringcase(actual, expected)) { String format = "expecting:&lt; ⁇ s&gt; to be equal to:&lt; ⁇ s&gt;, ignoring case considerations"; throw failures.failure(description, new basicerrormessagefactory(format, actual, expected)); } } xxeos 

Target: xxbos Verifies that two s are equal, ignoring case considerations. xxeos 

Predicted: xxbos Assert that the stringsxx are equal, oring the... xxeos 

Input: xxbos protected cronschedulebuilder createcronschedulebuilder(string cronexpr) { int i = cronexpr.indexof("["); int j = cronexpr.indexof("]"); timezone timezone = defaulttimezone; if (i &gt; -1 &amp;&amp; j &gt; -1) { timezone = timezone.gettimezone(cronexpr.substring(i+1, j)); cronexpr = cronexpr.substring(0, i).trim(); } return cronschedulebuilder.cronschedule(cronexpr).intimezone(timezone); } xxeos 

Target: xxbos Allow timezone to be configured on a per-cron basis with [timezonename] appended to the cron format xxeos 

Predicted: xxbos Create to to create used to the mtimei-s of a0],]. to the givenath.xxeos 

Input: xxbos private &lt;T&gt; fakeencodeditem readnextitem(class&lt;t&gt; clazz) { fakeencodeditem item = data[dataposition]; if (item == null) { / / While Parcel will treat these as zeros, in tests, this is almost always an error. throw new unreliablebehaviorerror("reading uninitialized data at position " + dataposition); } checkconsistentreadandincrementposition(clazz, item); return item; } xxeos 

Target: xxbos Reads a complete item in the byte buffer. xxeos 

Predicted: xxbos Read the   from the given array. xxeos 

Input: xxbos private void hidesuggestionsifnecessary(final @nonnull querytoken currentquery, final @nonnull tokensource source) { String queryts = currentquery.gettokenstring(); String currentts = source.getcurrenttokenstring(); if (!iswaitingforresults(currentquery) &amp;&amp; queryts != null &amp;&amp; queryts.equals(currentts)) { msuggestionsvisibilitymanager.displaysuggestions(false); } } xxeos 

Target: xxbos Hides the suggestions if there are no more incoming queries. xxeos 

Predicted: xxbos Check the givenion of of the is no more  . xxeos 

Input: xxbos public list&lt;uirow&gt; getvalues() throws efapsexception { list&lt;uirow&gt; ret = new arraylist&lt;&gt;(); if (isfiltered()) { for (final uirow row : this.values) { boolean filtered = false; for (final tablefilter filter : this.filters.values()) { filtered = filter.filterrow(row); if (filtered) { break; } } if (!filtered) { ret.add(row); } } } else { ret = this.values; } setsize(ret.size()); return ret; } xxeos 

Target: xxbos This is the getter method for the instance variable . xxeos 

Predicted: xxbos Returns method a first method for the row of. xxeos 

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is great and all. However, you can see the text looks a bit off. Your model sort of starts generating some word and then switches half way through sometimes. This is because the way you are currently trying to generate tokens is using <a href="https://towardsdatascience.com/what-is-teacher-forcing-3da6217fed1c">Teacher Forcing</a>, which means you are giving the model the groundtruth for what it should have produced even if it did not. This is very helpful during training, however, it expects to have both the x and y of an input. In a real world setting, you aren't going to be given the y, obviously!</p>
<p>Therefore, I found a hacky way of bypassing this need for the y so that it is no longer needed. This involves using an empty array that fakes being the y, but has only ones and is updated everytime the model makes a prediction and is then fed back into the model so that is knows what it has generated before.</p>
<p><strong>Heads Up</strong> The way I coded this is extremely inefficient and so running it will take a long time to generate predictions. Therefore I recommend only generating a few comments (I set it up to only do 10).</p>
<p><strong>TODO For You:</strong> Come up with a more efficient solution that performs similarly to the Teacher Forcing approach of the above code.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>P.S.</p>
<p>For other <a href="https://docs.fast.ai/text.learner.html#LanguageLearner.predict">language learners</a> provided by FastAI, you can simply use the <code>predict</code> function and pass some text and ask for the model to predict the next set of tokens. However, I have been unsuccessful in implementing this <code>predict</code> function for Sequence to Sequence models. So, another <strong>TODO For You</strong> is to see if you can implement a <code>predict</code> function for Sequence to Sequence models so that you can easily generate comments for methods that you just pass to the function!</p>
<p>If you do figure out a way to do this, I would be extremely interested! So, feel free to leave a comment about it.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#collapse_show</span>
<span class="k">def</span> <span class="nf">get_preds</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">db_tst</span><span class="p">,</span> <span class="n">max_seq</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">inpts</span><span class="p">,</span> <span class="n">trgts</span><span class="p">,</span> <span class="n">preds</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">progress_bar</span><span class="p">(</span><span class="n">db_tst</span><span class="o">.</span><span class="n">dl</span><span class="p">(</span><span class="n">DatasetType</span><span class="o">.</span><span class="n">Train</span><span class="p">))):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span> <span class="k">break</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xb</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">max_seq</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">'cuda'</span><span class="p">))</span><span class="o">.</span><span class="n">long</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_seq</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">outs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">out</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outs</span><span class="p">):</span>
                <span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="n">out</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yb</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
            <span class="n">inpts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">cpu</span><span class="p">())))</span>
            <span class="n">trgts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">db_tst</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">cpu</span><span class="p">())))</span>
            <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">learn</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">cpu</span><span class="p">())))</span>
    <span class="k">return</span> <span class="n">inpts</span><span class="p">,</span> <span class="n">trgts</span><span class="p">,</span> <span class="n">preds</span>

<span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">get_preds</span><span class="p">(</span><span class="n">learn</span><span class="p">,</span> <span class="n">db_tst</span><span class="p">)</span>
<span class="n">print_results</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">method_spm</span><span class="p">,</span> <span class="n">comment_spm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      &lt;progress value='10' class='' max='149', style='width:300px; height:20px; vertical-align: middle;'&gt;&lt;/progress&gt;
      6.71% [10/149 01:14&lt;17:21]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Input: xxbos protected String parseunquotedstringcontent() { final int startndx = ndx; while (true) { final char c = input[ndx]; if (c &lt;= ' ' || charutil.equalsone(c, UNQUOTED_DELIMETERS)) { final int currentndx = ndx; / / done skipwhitespaces(); return new String(input, startndx, currentndx - startndx); } ndx++; } } xxeos 

Target: xxbos Parses un-quoted string content. xxeos 

Predicted: xxbos Parses the text from the HTML text. xxeos 

Input: xxbos private static void checkfilecopy(final File srcfile, final File destfile) throws ioexception { checkexists(srcfile); checkisfile(srcfile); if (equals(srcfile, destfile)) { throw new ioexception("files '" + srcfile + "' and '" + destfile + "' are equal"); } File destparent = destfile.getparentfile(); if (destparent != null &amp;&amp; !destparent.exists()) { checkcreatedirectory(destparent); } } xxeos 

Target: xxbos Checks that file copy can occur. xxeos 

Predicted: xxbos Checks if the file is a file. xxeos 

Input: xxbos long analyze() { Arc a; Arc aa; if (pre.outs == null) { return flags.reg_uimpossible; } for (a = pre.outs; a != null; a = a.outchain) { for (aa = a.to.outs; aa != null; aa = aa.outchain) { if (aa.to == post) { return flags.reg_uemptymatch; } } } return 0; } xxeos 

Target: xxbos analyze - ascertain potentially-useful facts about an optimized NFA xxeos 

Predicted: xxbos Returns the Syoooo Syna Syna Syna Sa Sa Sa Sa Sa Sa Sa Sa syna Syna xxeos 

Input: xxbos @suppresswarnings("unchecked") public REC next() { checkdirection(true); orecord record; / / ITERATE UNTIL THE NEXT GOOD RECORD while (hasnext()) { / / FOUND if (currentrecord != null) { try { return (REC) currentrecord; } finally { currentrecord = null; } } record = gettransactionentry(); if (record != null) return (REC) record; } return null; } xxeos 

Target: xxbos Return the element at the current position and move forward the cursor to the next position available. xxeos 

Predicted: xxbos Returns the next record in the queue. xxeos 

Input: xxbos public static void addtransitivematches(hollowreadstateengine stateengine, map&lt;string, bitset&gt; matches) { list&lt;hollowschema&gt; schemalist = hollowschemasorter.dependencyorderedschemalist(stateengine); collections.reverse(schemalist); for(hollowschema schema : schemalist) { bitset currentmatches = matches.get(schema.getname()); if(currentmatches != null) { addtransitivematches(stateengine, schema.getname(), matches); } } } xxeos 

Target: xxbos Augment the given selection by adding the references, and the &lt;i&gt;transitive&lt; / i&gt; references, of our selection. xxeos 

Predicted: xxbos Add a variable to the list of s. xxeos 

Input: xxbos protected void resolvenestedproperties(final beanproperty bp) { String name = bp.name; int dotndx; while ((dotndx = indexofdot(name)) != -1) { bp.last = false; bp.setname(name.substring(0, dotndx)); bp.updatebean(getindexproperty(bp)); name = name.substring(dotndx + 1); } bp.last = true; bp.setname(name); } xxeos 

Target: xxbos Resolves nested property name to the very last indexed property. If forced, &lt;code&gt;null&lt; / code&gt; or non-existing properties will be created. xxeos 

Predicted: xxbos Resolve the property name. xxeos 

Input: xxbos public xmlconfig declarenamespace(string prefix, String namespaceuri) { validate.notempty(prefix, "prefix cannot be empty"); validate.notempty(namespaceuri, "namespace URI cannot be empty"); map&lt;string, String&gt; updatednamespaces = new hashmap&lt;string, string&gt;(declarednamespaces); updatednamespaces.put(prefix, namespaceuri); return new xmlconfig(features, updatednamespaces, properties, validating, true, allowdoctypedeclaration, true); } xxeos 

Target: xxbos Declares a namespace and also sets } to &lt;code&gt;true&lt; / code&gt;. &lt;p / &gt; &lt;p&gt;note that you cannot use this to add namespaces for the matcher. This has to be done by providing a to the matcher instance.&lt; / p&gt; xxeos 

Predicted: xxbos Creates a new instance of the given name and the given name. xxeos 

Input: xxbos protected static int getshadowradius(drawable shadow, Drawable circle) { int radius = 0; if (shadow != null &amp;&amp; circle != null) { Rect rect = new Rect(); radius = (circle.getintrinsicwidth() + (shadow.getpadding(rect) ? rect.left + rect.right : 0)) / 2; } return Math.max(1, radius); } xxeos 

Target: xxbos Calculates required radius of shadow. xxeos 

Predicted: xxbos Get the Syyyy Syyy Syyy Syna Syna Syna Syna Syna Sna Syna Syna Syna xxeos 

Input: xxbos void addadviceclinitmethod(final String name) { if (adviceclinits == null) { adviceclinits = new arraylist&lt;&gt;(); } adviceclinits.add(name); } xxeos 

Target: xxbos Saves used static initialization blocks (clinit) of advices. xxeos 

Predicted: xxbos Adds a Java class to the Saa Sa Sa Syyetch Bean. xxeos 

Input: xxbos public static String padleft(string s, int desiredlength, String padstring) { while (s.length() &lt; desiredlength) { s = padstring + s; } return s; } xxeos 

Target: xxbos Pad the given string with padstring on the left up to the given length. xxeos 

Predicted: xxbos Compares two strings, and returns the first character in the string. xxeos 

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Not too shabby if I do say so myself! It seems to actually be learning about what a comment is supposed to have in it for documenting what the method is doing. Of course there are a lot of tweaks you could do such as adding the ability to generate inline comments instead of just method level, using more data, using different sampling schemes for generating the comments such as <a href="https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277">top-k or nucleus</a>, and any other awesome things you could think of! And if you do feel free to leave a comment about your adventure.</p>
<p><strong>Tip:</strong>
I have done a lot of fiddling to get this to work, however, most of my models ended up overfitting. The way I fixed this issue was just being more careful in how I clean the data and also increase the data size. I know this seems simple, but it is quite effective.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h1>
<p>In this tutorial, you created an Automatic Code Comment Generator! You learned about how to clean, explore, and process data and how to use the awesome Pytorch and FastAI to define and train the awesome Transformer architecture. The use of Deep Learning in the field of Software Engineering is what I am studying for my Ph.D., so I hope I have inspired you to think about some other ways you could use Deep Learning to help Software Engineering!</p>
<p>I hope you enjoyed this tutorial and look out for future blog posts from me about all kinds of topics as I have announced a challenge for myself for learning new things this year!

</p>
<center>
    <div class="jekyll-twitter-plugin">
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">Okay, I'm posing a <a href="https://twitter.com/hashtag/challenge?src=hash&amp;ref_src=twsrc%5Etfw">#challenge</a> to myself: Each month devote an hour a day to learning about a subject I am weak at. At the end of the month, post a blog summarizing what you've learned.<br><br>March is devoted to <a href="https://twitter.com/hashtag/neuroscience?src=hash&amp;ref_src=twsrc%5Etfw">#neuroscience</a>! Already signed up for <a href="https://twitter.com/hashtag/edX?src=hash&amp;ref_src=twsrc%5Etfw">#edX</a> course!<a href="https://twitter.com/hashtag/ChallengeAccepted?src=hash&amp;ref_src=twsrc%5Etfw">#ChallengeAccepted</a> 😎</p>— Nathan Cooper (@ncooper57) <a href="https://twitter.com/ncooper57/status/1235408134904086529?ref_src=twsrc%5Etfw">March 5, 2020</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
</center>


</div>
</div>
</div>
&lt;/div&gt;
 

</div>
</div>
</div>
</div>
</div>
</div>


  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="ncoop57/i-am-a-nerd"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/i-am-a-nerd/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/i-am-a-nerd/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/i-am-a-nerd/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A singular place for all of my nerdy ramblings.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/ncoop57" title="ncoop57"><svg class="svg-icon grey"><use xlink:href="/i-am-a-nerd/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/ncooper57" title="ncooper57"><svg class="svg-icon grey"><use xlink:href="/i-am-a-nerd/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
