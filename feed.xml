<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://nathancooper.io/i-am-a-nerd/feed.xml" rel="self" type="application/atom+xml" /><link href="https://nathancooper.io/i-am-a-nerd/" rel="alternate" type="text/html" /><updated>2020-03-07T16:58:26-06:00</updated><id>https://nathancooper.io/i-am-a-nerd/feed.xml</id><title type="html">IAmANerd</title><subtitle>A singular place for all of my nerdy ramblings.</subtitle><entry><title type="html">How to Create an Automatic Code Comment Generator using Deep Learning!</title><link href="https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html" rel="alternate" type="text/html" title="How to Create an Automatic Code Comment Generator using Deep Learning!" /><published>2020-03-07T00:00:00-06:00</published><updated>2020-03-07T00:00:00-06:00</updated><id>https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning</id><content type="html" xml:base="https://nathancooper.io/i-am-a-nerd/deep_learning/software_engineering/2020/03/07/How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-07-How_to_Create_an_Automatic_Code_Comment_Generator_using_Deep_Learning.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;About&quot;&gt;About&lt;a class=&quot;anchor-link&quot; href=&quot;#About&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this post, you will be create a Deep Learning model that given a piece of code, will automatically generate a comment describing (hopefully 🤞) what the piece of code does. This post will focus on Java code, however, the same approach should be able to be applied to other programming languages such as Python or Javascript.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Collecting,-preparing-and-exploring-the-data&quot;&gt;Collecting, preparing and exploring the data&lt;a class=&quot;anchor-link&quot; href=&quot;#Collecting,-preparing-and-exploring-the-data&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;You will be using the &lt;a href=&quot;https://github.blog/2019-09-26-introducing-the-codesearchnet-challenge/&quot;&gt;CodeSearchNet Challenge&lt;/a&gt; dataset from GitHub as it provides a large collection of clean code in multiple different languages. They have a really nice &lt;a href=&quot;https://github.com/github/CodeSearchNet/blob/master/notebooks/ExploreData.ipynb&quot;&gt;example&lt;/a&gt; on how to download and read in the data in their repo that you'll use to get started.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; wget https://s3.amazonaws.com/code-search-net/CodeSearchNet/v2/java.zip
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; unzip java.zip
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;--2020-03-07 16:37:37--  https://s3.amazonaws.com/code-search-net/CodeSearchNet/v2/java.zip
Resolving s3.amazonaws.com (s3.amazonaws.com)... 52.216.179.149
Connecting to s3.amazonaws.com (s3.amazonaws.com)|52.216.179.149|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1060569153 (1011M) [application/zip]
Saving to: ‘java.zip’

java.zip            100%[===================&amp;gt;]   1011M  88.0MB/s    in 12s     

2020-03-07 16:37:49 (84.9 MB/s) - ‘java.zip’ saved [1060569153/1060569153]

Archive:  java.zip
   creating: java/
   creating: java/final/
   creating: java/final/jsonl/
   creating: java/final/jsonl/train/
  inflating: java/final/jsonl/train/java_train_12.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_9.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_3.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_5.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_7.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_1.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_10.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_14.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_0.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_6.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_8.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_15.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_2.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_4.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_13.jsonl.gz  
  inflating: java/final/jsonl/train/java_train_11.jsonl.gz  
   creating: java/final/jsonl/test/
  inflating: java/final/jsonl/test/java_test_0.jsonl.gz  
   creating: java/final/jsonl/valid/
  inflating: java/final/jsonl/valid/java_valid_0.jsonl.gz  
  inflating: java_dedupe_definitions_v2.pkl  
  inflating: java_licenses.pkl       
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;code&gt;jsonl_list_to_dataframe&lt;/code&gt; method is directly from the CodeSearchNet Challenge example code and &lt;code&gt;get_dfs&lt;/code&gt; is just a helper for you to properly grab the data into the correct training, validation, and testing splits. Let's see what your data looks like :D!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;jsonl_list_to_dataframe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Load a list of jsonl.gz files into a pandas DataFrame.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;orient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;records&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                   &lt;span class=&quot;n&quot;&gt;compression&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;gzip&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; 
                      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_dfs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Grabs the different data splits and converts them into dataframes&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;dfs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;split&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;valid&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;files&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;glob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;**/*.gz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jsonl_list_to_dataframe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;docstring&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dfs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dfs&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_dfs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;java/final/jsonl&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;code&lt;/th&gt;
      &lt;th&gt;docstring&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;protected final void bindIndexed(Configuration...&lt;/td&gt;
      &lt;td&gt;Bind indexed elements to the supplied collecti...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;public void setServletRegistrationBeans(\n\t\t...&lt;/td&gt;
      &lt;td&gt;Set {@link ServletRegistrationBean}s that the ...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;public void addServletRegistrationBeans(\n\t\t...&lt;/td&gt;
      &lt;td&gt;Add {@link ServletRegistrationBean}s for the f...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;public void setServletNames(Collection&amp;lt;String&amp;gt;...&lt;/td&gt;
      &lt;td&gt;Set servlet names that the filter will be regi...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;public void addServletNames(String... servletN...&lt;/td&gt;
      &lt;td&gt;Add servlet names for the filter.\n@param serv...&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You are going to only use a small subset of the data in order to train your model in a reasonable time. However, if you want to adjust the amount of data used you can just adjust the sample size.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Awesome! Now that you have the data, there's a few other preprocessing steps you need to perform. First we are going to remove any non-english comments. Next, you will also remove the JavaDocs, i.e., any line with an @ symbol or curly braces, as that will significantlly lessen the amount of learning your model will have to do. This also works out well since the JavaDoc syntax can usually be autogenerated from the method's signature.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# From https://stackoverflow.com/a/27084708/5768407&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isASCII&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ascii&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;UnicodeDecodeError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isASCII&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isASCII&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isASCII&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;filter_jdocs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;comments&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;progress_bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterrows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;docstring&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Remove {} text in comments from https://stackoverflow.com/questions/14596884/remove-text-between-and-in-python/14598135&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;([\{\[]).*?([\)\}])&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        
        &lt;span class=&quot;n&quot;&gt;cleaned&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;@&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;cleaned&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;comments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cleaned&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;methods&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;docstring&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_df&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filter_jdocs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filter_jdocs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filter_jdocs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='88221' class='' max='88221', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [88221/88221 00:02&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='2840' class='' max='2840', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [2840/2840 00:00&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='5254' class='' max='5254', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [5254/5254 00:00&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now you are going to remove any empty comments or duplicate comments for your datasets.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duplicated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duplicated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duplicated&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Not bad, still leaves you with plenty of data to learn with!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(73755, 2427, 4615)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Exploring-your-data!&quot;&gt;Exploring your data!&lt;a class=&quot;anchor-link&quot; href=&quot;#Exploring-your-data!&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As a good machine learning practitioner, it is extremely important to be careful with your data. This includes checking for biases, duplicates, and also describing the data that you have. Not doing so is setting you up for disaster. I have personally experienced such travesty when working on one of my own research projects where I forgot to check for duplicates before splitting my data. Sadly for me and all my restless nights working on the project, the data was full of duplicates and so my test set was contaminated with data points from my training set, which lead to inflated evaluation metrics :(.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Always explore your data!&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You'll be doing some basic descriptive statistics for this Exploratory Data Analysis (EDA), which just means calculating some means, medians, and standard deviations for different views of your data. The first view you will be exploring is the tokens that make up your code and comments. To tokenize your data into these tokens you will use something called Byte Pair Encoding, which has shown great results for tokenizing both natural language and code as shown in Karampatsis and Sutton's paper &lt;a href=&quot;https://arxiv.org/abs/1903.05734&quot;&gt;&quot;Maybe Deep Neural Networks are the Best Choice for Modeling Source Code.&quot;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;A great resource on learning more about how Byte Pair Encoding works is this &lt;a href=&quot;https://towardsdatascience.com/byte-pair-encoding-the-dark-horse-of-modern-nlp-eb36c7df4f10&quot;&gt;blog post&lt;/a&gt; by Akashdeep Singh Jaswal and this &lt;a href=&quot;https://youtu.be/9oTHFx0Gg3Q&quot;&gt;Youtube video&lt;/a&gt; by Christopher Manning. Specifically, you will be using the awesome library by Google called &lt;a href=&quot;https://github.com/google/sentencepiece&quot;&gt;sentencepiece&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;df_to_txt_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Converts a dataframe and converts it into a text file that SentencePiece can use to train a BPE model&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text.txt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text.txt&amp;#39;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;gen_sp_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Trains a SentencePiece BPE model from a pandas dataframe&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_to_txt_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SentencePieceTrainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;--input=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fname}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; --model_prefix={output / tokenizer_name} --hard_vocab_limit=false&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To use Byte Pair Encoding, you have to train the tokenizer on your data. However, no need to train your BPE on all of your data, so you will just be doing it on a subset (10%) of your training data. You are picking to train the BPE model from your training set to not perform any inadvertant data snooping by biasing your BPE model to tokenize more common words in your validation or testing set. This also will help show that you are indeed solving the out of vocabulary problem because you will most likely encounter words in your testing set that were not in your training set.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p_bpe&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;method_tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;method_bpe&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gen_sp_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p_bpe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;comment_tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;comment_bpe&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gen_sp_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p_bpe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;docstring&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now that you have the ability to tokenize your text, let us explore! First you will just generate the frequency of each of your tokens and while you are at it, let's collect how long your methods are by via the common software metric Lines of Code (LOC).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_counter_and_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;toks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;progress_bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iterrows&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;toks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EncodeAsPieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
            
    &lt;span class=&quot;n&quot;&gt;cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tok&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;progress_bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tok&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;  
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;toks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;code_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;code_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_counter_and_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;comment_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_counter_and_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='73755' class='' max='73755', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [73755/73755 00:26&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='12402148' class='' max='12402148', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [12402148/12402148 00:12&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='73755' class='' max='73755', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [73755/73755 00:07&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='2530502' class='' max='2530502', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [2530502/2530502 00:02&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;22&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dpi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;facecolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;edgecolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xticks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indexes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plot_counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_k&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
0KCEhISg1PG/ZlssFm3dujUoNYDOFBYWmvLD/He+8x3Nnj2728brze+Nly5dqrKyMpWVlWnNmjWS
Og8w2traAq8pwWaGfVt3P46uZgQYCJqGhga1trYqOjra6FYM069fP505c8boNkLuq6++0r/9278Z
3UbI2Gw2lZSUGNrDli1bNGHChJDV829zqL49MYM//vGP+u53v6uxY8ca9u3kI488YkhdP7vdri+/
/FI/+9nPtHnzZj366KNXPN5TTz2lO++8Uz6fTz/5yU80duxYjR8/XjU1NXrllVf08ccfy263a8eO
HYH6knTffffp6NGjKiws1PTp0zV58mQVFxfr9ttv1+OPP67vfve7eu655y66F6/Xq/vuu0/jx4/X
Y489ptzcXBUXF8tms8lisWjjxo3629/+puLiYn3/+9/XU089dUXbfrG++OILDRgwQJK0e/duDRs2
LCh12r9mT5gwQVu2bJF09kPlzp07g1JTOvsYeOKJJ5Senq7HH39cknTmzBnNmDFDGRkZuvvuu9XU
1KTXX39dGzZs0OnTp3XNNdfo73//u9577z0tWLCg2+sXFhbqpZdekiS99dZbIX++Nzc3q6WlJaQ1
/datW6c77rgjcF/0ZHa7XT/5yU+Unp6un/3sZ5I6/9t++eWXuv/++zV8+HBt2LDhnHHcbrfmzJkj
6ew3+SNHjpTdbtf//u//XnJP7Z9n69at0+OPP6477rjjCrby4rW0tKi5uTmoNU6fPi2Px6PW1lbF
x8fr9OnTKiws1DPPPKNZs2bJ7XZr8uTJmjJligoLCwP79MLCQt17772aPHmyRowYoc8//1yS9Itf
/EKjRo3ST3/6U91+++2X1VNn+7ZQa/84wpUhwEDQfPLJJxo8eLDRbRgqNjZWNTU1RrcRctXV1YqN
jQ1pzV/96ley2+3n/CxdujQktb/5zW/qo48+Ckmtzhw8eFDf/OY3Q1bPv82h+vbEDIqKirRgwQK9
++67mj9/viE9vPbaa4bUPd+yZcs0bdo0vfzyy1c81p133qlt27apqKhI8fHxevfdd7VkyRItXbpU
s2fP1s033yy3262MjIxOx4iMjNSbb76p7OxsNTQ06Mknn5TH47mkDxhbtmzRTTfdpNLSUt16663y
+XwqKCjQ9u3bVV5erpdeekkpKSnKysrS//zP/2jZsmVXvO0Xo6SkRHfeeackqbi4WHfddVdQ6rR/
zW6/T8vNzdWoUaOCUtPvnnvuUVlZmaqqqtTY2KhVq1YpIyNDO3bs0AMPPKDXX39dNptN5eXlev/9
95WRkaHy8nKVl5crPT292+sb5S9/+YueeOIJZWRkGNZHSkqK+vXrp8TEREPqd7fJkyerrKxMX3zx
hf70pz91ul5NTY1WrlypyspKLVu2TK2trRes09bWpmeeeUZbt26V2+2+rFkU7Z9nKSkpSkxMVL9+
/S55nMvR2NiojIwMPfHEE/rLX/4SlBrr16/Xiy++qBtvvFELFy5U3759lZubq1/+8pdat25doI/N
mzfroYceOud3Y2Nj9eabb+qhhx6Sy+XSsWPHVFJSIo/Ho8cff1z19fWX1VNn+7berqv3xUa+Z+4O
wZ9rDFzFbr31Vn388ceaPn36VXE4hXT2Q96DDz6oTZs2hbTuk08+qSeffDKkNXF1eeyxx7R48WKt
X79eDzzwgLKzs41uqVcYMWKEJOmjjz7S7373O5WVlcnn8yk5OfmCdcPCwgL/bn8cs38MSYqPj9eg
QYMk6ZJmAB4+fDgwu2HYsGHasmWLPvnkE2VmZko6+y3e8ePHL2HLuse2bdv04osvSjo7A2PevHkh
7yHYbrvtNknSf/zHf6ihoUEfffSRPvjgA61bt04tLS2y2WxKS0vTgQMHVFZWprlz52rDhg2qrq7W
E0880e31O3ucBUNLS4sKCwu1adMmDRo0SN///ve1fPnyoNY0m0WLFmnHjh06duyYoqOjFRcXp+99
73v60Y9+dMVj+5/TI0aM0KFDhzr9237jG98IHJqVnJysEydOXDDW8ePHlZycrJiYGElSeHjP+h44
MTFRFRUV8ng8euGFF/Tpp5/qvvvuU25uriIjI7ulxvDhw/Xb3/5Wzc3NysrK0sGDBztcp/3fwc//
PExOTlZVVZWOHj2qoUOHKiwsTDfddJP69+/fLT1eLbp6X9zT3zMTYCBobrrpJh09etToNgy1d+9e
paamhjS8qKmpUVJSUsjqnW/ixInavHmz1q1bJ7vdHrK6v/rVr1RUVHTOsqysLD399NNBr/3Xv/5V
Q4YMCXqdrtx8883661//GrJvzfzbXFtbq+uvv77DNyO9TWxsrF566SU1Nzdr2LBhhgQYRj+/g8H/
ISAtLU0Oh0P//d//LUmBKfTtH1vx8fGqqanRjTfeeM43iO0/SFzuY/HGG2/Unj17dO+992rPnj1K
TExUWlqatm7dqqioKLW0tCgyMlKRkZEdfjsbDG1tbWpqalJcXJzq6uoUHx8ftA9N7V+z2+/T6urq
FB0dHdRvic//UJmWlqZRo0Zp5syZks4+FsLCwpSQkKDKykrNnz9fy5cv11dffdUtfZ1fPz4+XgcO
HJCkwMlTg+XkyZN69dVXdS2onNYAAASPSURBVPvtt2v27NmBD3FXk/nz52v+/PkqLCzU4MGDu/W9
w549ezR+/Hjt3r1bdrtdtbW1Hf5tjx49qvr6evXr10/V1dUdvpZee+21qqmp0Zdffqn+/furra3t
kp+PZnhvbLFY1LdvX7388st69dVXde+993bbeXUOHTqk1NRURUVFKTY2Vj6f74J9Zmf32fnPw8GD
B2v//v3y+Xw6fPhw4PDBS9XZvq236+p9sZHvmbtDz4oOcVmOHTt2xceIXo64uDiFh4dfleeA8Gtq
alJKSkrI6nm9Xt1///0hq9eZlJSUkJ/g8cknn5Tb7T7nJ1Q74vLy8sAUb6Pcc8892rZtW8jq+bd5
xowZQT+m1ixee+01paeny263Kzc3N+T1zfL8DpbJkyfrn//8p8aOHauMjIzAdOObb75Z9957ryor
K/Xoo48qJydHDz74YOC8EN3lnnvu0cGDBzVu3Di9//77uuaaazRv3jxNmDBBY8eODUwXv+uuu5SX
l6clS5Z0a/2O7Nq1KzC7ZOvWrUE9z0371+xt27bpP//zPyVJy5cvD+o5MDryox/9SNu2bVNGRoYy
MjICJ90bPXp04PxK1113XdA+7I8fP14ej0fZ2dn69NNPg1LDLyEhQVVVVXr00Ue1evVqjR07VitW
rNBXX30V1LpXi3feeUfp6elKTEzUsGHDOv3bJicn66c//amsVqvmzJmjiIiIC8YKDw/XkiVLNG7c
OI0dO1br16+/5H6MfG/81VdfacWKFRo7dqxWr16tRx99VFVVVd16UuA5c+bIYrFo9OjRSktL05Ah
Q5SRkaHnn38+cB6Si3XddddpwoQJGjVqlFasWHHZfXa2b+vtunpfbOR75u4Q5uM6WQiioqIiHTt2
TD/4wQ9CUq/9JSRDcTWG82u2Fx4erjfffFNVVVVatGhRSHrZtWuX9u3bpx/+8IdBr9XVdh8/flwP
PPBAt12h4GLrGjGds7q6Ws8//7xWrFgRknpdbf/999+v9evXB/2x79/m559/Xo899pheffXVoNbD
WWZ5fl/O88xsz9vO+GdZvP7666qvr1d+fn7Iand0H1VVVSkxMVE33HCDSkpKNHz4cP37v/970Hrw
v2Zv3bpVGzduVHh4uGbPnq0XX3zxivcrRj8GjK5/sc6cOaPNmzcrKysraFebkYy5P4JVs7NxMzIy
9Pbbb5vu0INQvzf2q6urU3FxsaZOnXrFJ9gP1ePHv0/+5JNPlJeXp7fffvuyxulo39Zb9JR9W7fy
Ab2IpMBPKFRXV59Ts/3PkCFDfOnp6b49e/aEpJdQ6mq7FyxY4PP5fL5Zs2b5HA5HyOv2Zlf79vt8
Pl9DQ4NvzJgx5/zs3r3b6LZ6le5+nPWkx+1dd93ls9lsvvHjx/v++c9/hqxuT7qPLofR22d0fbMx
4v4IVs2uxh0zZozv5MmT3bcR8Pl8oX38PPPMM7709HTfiBEjfB988EG3jt0bXK37NmZgAAAAAAAA
0+ul80oAAAAAAEBvQoABAAAAAABMjwADAAAAAACYHgEGAAAAAAAwPQIMAAAAAABgev8PFLEHrpOd
occAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
JjY21jQ1NRljPPuYT0xMbHUf3759u3nppZfMihUrjDHG/PnPfzbPPvusx+q11Hz7/9hcyH7rQp3v
vtVTznUfb9lTTk6OWbZsmTHGmMGDB7er3tChQ83//d//mZMnT5q+ffuaQ4cOmVWrVpmXXnrJfPPN
N+45r1u3zrzwwgumqqrK3J254DUAAAj1SURBVHzzzaapqcl8/fXXJjEx0d138+uomJgY89VXX/1g
XsXFxcblcpkrr7zS7NixwzQ2Npobb7zRGGNMenq6+eyzz4wxxkybNs188skn7j6MMebQoUPm5z//
uWlsbDR79uwx48aNc/d/6j43LS3N7Nu3z7hcLhMbG2s2b97cruum+ba4GB53nfwdoODiN2jQIElS
7969VVNToz179qi0tFRJSUmSdFH9ZO6MGTP0n//5n1q3bp1+9atfKTU11Sd1e/TooeLiYpWWlurF
F1/UkSNHNGHCBGVmZio4ONgnPTT74x//qHXr1ikwMNBrnxKezubNm1VSUqJZs2YpPT1d3bp180nd
f/zjH4qMjPRJrbP57LPPFB0dLUmKjo7WgQMHlJCQ4OeuvMPlcqlHjx6SpGuuuUbHjh3zWe1BgwYp
ICBA/fv39+n9+1S//e1v9dxzz+nbb7/VjBkzFBMT45U6jY2NWr16tdavX68+ffro7rvvdn+S5k1n
2o+c+nzy2WefafDgwZK+v99/9NFH511j7969SkxMdP99/Phx9e/fX5J044036uDBgz/YviS/PYe1
nPv27dt9UvNMj7Xm68JTunfvrj59+kiSunTpIkmtrvvm/3vanj179NZbb2nLli0yxig4OFgDBw50
P8Z99TzS7NT7d7Pg4GDNmDFDkydP1k9+8hMtWrTIo721vI8fOHBAe/bs0SeffKLXXntNjY2Nstvt
HqtlJTk5OXrnnXc0evTocx4y5UkXst+6UOe7b/WWU+t8/fXXuu+++3T06FFVV1e363shWnK5XAoP
D5ckXXfdda1O69q1qyIjI/U///M/Wr9+vV5++WUdPHhQn376qYYNGyZJ+vLLL3/Q65VXXqmvvvpK
oaGhrbY3cOBABQYG6vLLL9cNN9yggIAA92vuffv26Z577pEk1dfX6+abb/5Br9ddd506derU6jo/
3T73+PHjuvbaayV5b1/Y0XAICTwuODhYLpfL/XdAQID738YY9evXT4mJiSosLFRhYaE2bdrkjza9
IjQ0VC+//LJWrVqlrKwsn9ePi4vT9OnTFRkZqVdffVX19fU+7+Gll17S5s2b9cYbb3hsGeL5mDlz
pkpKStTU1KRx48YpMzPT6y/y9+/fr5///OderXE2LR9r11xzjfvYyk8++URRUVFer3/06FGv1zid
wMBAVVVVqbGxUQcOHNAVV1zhs9plZWUyxmj//v3q1auXz+qeqnfv3lq2bJkWL16suXPneq1OfX29
Xn31VUVGRmr69OmKjY31Wq2WzrQfOfX55JprrtGOHTskSdu2bWtTjf79+2vLli3uvy+77DLt3btX
xhj993//t66++urTbt9fz2Gnzt0XzvRYCwz07MvHlnNr1vK6b/6/p/Xr108ZGRkqLCzUhx9+qFWr
VmnXrl3ux7i3v9zyXK+XmrlcLmVkZGjt2rXq2bOn3nzzTY/20fI+fs0116hfv3769a9/rcLCQpWU
lCg7O9uj9ZqdOn9fe/jhh1VYWOjT8ELSBe23LtT57ls95Vz38by8PF111VX68MMPlZmZ6a59un3C
+QgKClJNTY0aGhr06aef/uD0iRMnatmyZfrmm290xRVX6Gc/+5kGDhyozZs3q7CwUGVlZWfs9VQt
Tz+132uvvVZr1qxRYWGhtm3bprS0tPN6vJ9un9uzZ08dOHDA/dwEiRUY8LixY8cqIyNDt95662lP
HzhwoKKiopSYmKjAwECNGjXK4y/Ajx8/rqVLl/r8y69+//vf680335TT6fTpt0p/9913Wrp0qTZs
2KABAwbo/vvvdyfHvhYfH6/4+HjFxMT4/NOrbt266Z577tE999yjvXv36u9//7tX623atEm33HKL
V2ucTcvHWlZWlu666y49+eSTuu6667y++sLpdOr2229XUVGRV+uczpNPPqnRo0crICBADzzwgE+/
5DA0NFRjxozRF198oRUrVvis7qkWLFigrVu3qqGhQTNnzvRanfDwcG3fvl07duzQihUr9Omnn+oX
v/iFpk+frksuucRrdc93P/LLX/5Sf/7znzVixIg2h4ljxozRpk2bFB8fr+DgYM2fP19Tp06VMUaj
R49W3759NWfOHN1xxx167rnnFBISIsk3z2FW4c/H2pw5c3T77bfr+eefV9euXb2ymnDMmDEqKCjQ
sGHDFBAQoF/96ldKTk5WbGysBg8erO7du3u8Zkvner3UrL6+Xr/4xS8UEBCggIAArVu3zqN9vPfe
e1q4cKFuuOEGDR48WAMGDNC9996rVatWSZIeeeQRjR492qM1Jen666/XY489pvT0dP3hD39QWFiY
x2tY0YXsty6Ur1+jnes+HhMToyeffFI7duxQz5493Star732Wt166616+OGHZbPZzrvewoULNWLE
CF111VW6/PLLf7DfuPnmmzVlyhQtXLhQ0vcrmG+77TYlJiYqKChI119/vf7rv/6rnbP9p8WLF2va
tGk6efKkgoKCtHLlSsXGxurOO+/U3/72Nz355JOnvdzp9rnZ2dm644479NOf/tTr+6SOIsD48iNS
+IzT6TzteGBgoMc+OfFFDZyf6upqbdq0SePHj3cvv/U2f93+VrrfTZgwQevWrfPqGznJWnNu9vHH
H6u8vFz//u//7rUaVpt3YWGh3n33XT333HNer2W1uTc7efKk3nzzTaWkpLiX6V4Iq87T1/xxPVj9
unc6nerU6fvP2e644w49+OCDGjp0qJ+7ah8rXNdW6AG+4+vb2yr1XC6XLrnkEn333XeKjo7Wjh07
Lugwv474uOmIPbfVxTELtHL06FEFBwef9r/mxLEj1MD5Cw8P1x133OGz8MJft7/V7nfjx4/3enhh
tTk3GzJkiFfDC6vO2xesPPcuXbrojjvu8Eh4YeV5+pI/roeOcN0fOXJEdrtdsbGxCgkJ6bDhhRWu
ayv0AN/x9e1tpXo33nijkpKSFBsbq1mzZl1QeNERHzcdsef2YAUGAAAAAACwPFZgAAAAAAAAyyPA
AAAAAAAAlkeAAQAAAAAALI8AAwAAAAAAWB4BBgAAAAAAsLz/Byf5uN9NkeDaAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Plotting your frequencies as a bar chart you start to see a nice picture of your data. Not that suprising, but the most common token happens to be the period and some other common syntactical tokens like curly braces and also key words like &lt;em&gt;if&lt;/em&gt; and &lt;em&gt;return&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_bins&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;patches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_bins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;facecolor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stdev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stdev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stdev&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_lens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3.4662519750610943 3.0 2.6490695431339177
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;18.54957629991187 10 50.99032748692644
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;3.57512896650546 3.0 2.605938655784157
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
RwH1zAAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As you can see, there are HTML elements left with &amp;lt; and &amp;gt; occurring quite often in your comments dataset that may make it harder for your model to learn to generate the comments that contain those elements. Luckily for us, it won't really affect your models accuracy, but exploring your data like this does allow us to see how your data may be influencing your model.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TODO For You:&lt;/strong&gt; Perform some further cleaning steps to remove HTML and any other cleaning you deem necessary and see how your performance changes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Loading-the-data-using-FastAI&quot;&gt;Loading the data using FastAI&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-data-using-FastAI&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that you have the data processed and cleaned you need a way to get it into the format that FastAI uses. To do that you will use some code from Rachel Thomas' awesome &lt;a href=&quot;https://github.com/fastai/course-nlp/blob/master/7-seq2seq-translation.ipynb&quot;&gt;course on NLP&lt;/a&gt;, which allows us to create a Sequence to Sequence (since you are going from the sequence of code to the sequence of the code's docstring) DataBunch (this is just the format FastAI uses for managing loading the data into memory for training and evaluating).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;seq2seq_collate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_first&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backwards&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Function that collect samples and adds padding. Flips token order if needed&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;max_len_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_len_y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res_x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_len_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;res_y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_len_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backwards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_first&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_first&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;samples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_first&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;res_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LongTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LongTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;         
            &lt;span class=&quot;n&quot;&gt;res_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LongTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LongTensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backwards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res_x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res_y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res_x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res_y&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Seq2SeqDataBunch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TextDataBunch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Create a `TextDataBunch` suitable for training an RNN classifier.&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;dl_tfms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_first&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;no_check&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backwards&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dl_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&amp;quot;Function that transform the `datasets` in a `DataBunch` for classification. Passes `**dl_kwargs` on to `DataLoader()`&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_init_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_bs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ifnone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;partial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq2seq_collate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_first&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_first&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backwards&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backwards&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;train_sampler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SortishSampler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sampler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_sampler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_last&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dl_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dataloaders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;lengths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;sampler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SortSampler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lengths&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dataloaders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sampler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sampler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dl_kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataloaders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;no_check&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no_check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Seq2SeqTextList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TextList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_bunch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Seq2SeqDataBunch&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_label_cls&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TextList&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Here is where you are telling FastAI to use your trained BPE models for tokenizing your data. FastAI's tokenizers will also do some additional processing of your text such as lower casing all words, removing repetitions, etc. You can find a full list of the processing FastAI uses &lt;a href=&quot;https://docs.fast.ai/text.transform.html#Tokenizer&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_processor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SPProcessor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sp_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;.model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sp_vocab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;.vocab&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;include_eos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;comment_processor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SPProcessor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sp_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;.model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sp_vocab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_tokenizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;.vocab&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;include_eos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now that you have your BPE model you will generate the DataBunches suitable for your task, which will be the Seq2Seq DataBunch. You will also filter out sequences that your too long so that you can fit everything onto a Google Colab GPU and to not have your training take too long.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;gen_dbs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;is_valid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df_merged&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df_merged&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_merged&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_merged&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;docstring&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                                &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;docstring&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;valid&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                             
    &lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Seq2SeqTextList&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_merged&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;processor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_from_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;valid&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_from_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label_cls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TextList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;processor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter_by_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;databunch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Seq2SeqTextList&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;processor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_by_rand_pct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_pct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_from_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;docstring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label_cls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TextList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;processor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filter_by_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;databunch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gen_dbs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_processor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;text&lt;/th&gt;
      &lt;th&gt;target&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;▁ xx b os ▁boolean ▁res er ve ( int ▁column , ▁int ▁size ) ▁{ ▁if ▁( ( column ▁&amp;lt; ▁0) ▁|| ▁( ( column ▁+ ▁size ) ▁&amp;gt; ▁columns )) ▁throw ▁new ▁index out of bound s exception (&quot; res er ve ▁- ▁ inc or rec t ▁column ▁/ ▁size &quot;); ▁for ( int ▁i = column ; ▁i ▁&amp;lt; ▁column ▁+ ▁size ; ▁i ++) ▁{&lt;/td&gt;
      &lt;td&gt;▁ xx b os ▁ xx ma j ▁re s er ve s ▁a ▁&amp;lt; code &amp;gt; ce ll &amp;lt; ▁/ ▁ xx up ▁code &amp;gt; ▁in ▁the ▁&amp;lt; code &amp;gt; ro w &amp;lt; ▁/ ▁ xx up ▁code &amp;gt; . ▁ xx e os&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;▁ xx b os ▁@ help ( ▁ help ▁= ▁&quot; get ▁all ▁the ▁ virtual network function descriptor ▁ xx m a j ▁dependency ▁of ▁a ▁network service descriptor ▁with ▁specific ▁id &quot; ▁) ▁public ▁list &amp;lt; v n f d ep end en cy &amp;gt; ▁get v n f dependencies ( final ▁ xx m a j ▁string ▁id ns d ) ▁throws ▁s d k exception ▁{&lt;/td&gt;
      &lt;td&gt;▁ xx b os ▁ xx ma j ▁return ▁a ▁ xx ma j ▁list ▁with ▁all ▁the ▁v n f de p end en c ies ▁that ▁are ▁contain ed ▁in ▁a ▁specific ▁network service descriptor . ▁ xx e os&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;▁ xx b os ▁@ override ▁public ▁void ▁delete as set and attachment s ( final ▁ xx m a j ▁string ▁as set id ) ▁throws ▁ io exception , ▁request failure exception ▁{ ▁ xx m a j ▁as set ▁as s ▁= ▁get un v er ified as set ( as set id ); ▁list &amp;lt; attachment &amp;gt; ▁attachment s ▁= ▁as s . get attachment s&lt;/td&gt;
      &lt;td&gt;▁ xx b os ▁ xx ma j ▁this ▁will ▁delete ▁an ▁asset ▁and ▁all ▁its ▁attachments ▁ xx e os&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;▁ xx b os ▁public ▁list &amp;lt; character book mark fold er s response &amp;gt; ▁get character s character id book mark s fold er s ( integer ▁character id , ▁ xx m a j ▁string ▁data source , ▁ xx m a j ▁string ▁if n one match , ▁ xx m a j ▁ integer ▁page , ▁ xx m a j ▁string ▁token ) ▁throws ▁api&lt;/td&gt;
      &lt;td&gt;▁ xx b os ▁ xx ma j ▁list ▁ bookmark ▁folders ▁a ▁list ▁of ▁your ▁character &amp;amp; ' s ▁personal ▁ bookmark ▁folders ▁--- ▁ xx ma j ▁this ▁route ▁is ▁cached ▁for ▁up ▁to ▁36 00 ▁seconds ▁ xx up ▁ s so ▁ xx ma j ▁scope : ▁ esi - bookmark s . read _ character _ bookmark s . v 1 ▁ xx e os&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;▁ xx b os ▁@ de pre c ated ▁protected ▁final ▁map &amp;lt; db id , ▁k n n list &amp;gt; ▁batch n n ( n ▁node , ▁db id s ▁ids , ▁int ▁k max ) ▁{ ▁map &amp;lt; db id , ▁k n n list &amp;gt; ▁res ▁= ▁new ▁hash map &amp;lt;&amp;gt;( id s . size ()); ▁for ( db id iter ▁iter ▁= ▁ids . iter ();&lt;/td&gt;
      &lt;td&gt;▁ xx b os ▁ xx ma j ▁perform s ▁a ▁batch ▁k - ne a rest ▁neighbor ▁query ▁for ▁a ▁list ▁of ▁query ▁objects . ▁ xx e os&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shift_tfm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Add the necessary shift transformation for training your Transformer model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_tfm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift_tfm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_tfm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shift_tfm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Defining-your-model&quot;&gt;Defining your model&lt;a class=&quot;anchor-link&quot; href=&quot;#Defining-your-model&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this example, you will be using the Transformer architecture that was developed by &lt;a href=&quot;https://arxiv.org/abs/1706.03762&quot;&gt;Vaswani et. al.&lt;/a&gt;. If you want a better understanding of this model, I highly suggest &lt;a href=&quot;http://nlp.seas.harvard.edu/2018/04/03/attention.html#applications-of-attention-in-our-model&quot;&gt;The Annotated Transformer&lt;/a&gt; blog post and the &lt;a href=&quot;https://www.youtube.com/playlist?list=PLtmWHNX-gukKocXQOkQjuVxglSDYWsSh9&quot;&gt;NLP course&lt;/a&gt; by Rachel Thomas, which this model code is copied from.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PositionalEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Encode the position with a sinusoid.&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register_buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;freq&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;freq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TransformerEmbedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Embedding + positional encoding + dropout&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emb_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inp_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;emb_sz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emb_sz&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emb_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PositionalEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;emb_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp_p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; 
        &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;emb_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;feed_forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_ff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ff_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_ff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReLU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff_p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SequentialEx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_ff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff_p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MergeLayer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LayerNorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ifnone&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_wgt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k_wgt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_wgt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_att&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LayerNorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ln&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_apply_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create_attn_mat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;
                            &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;_apply_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;wq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_attn_mat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                       &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q_wgt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k_wgt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v_wgt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attn_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attn_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
            &lt;span class=&quot;n&quot;&gt;attn_score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attn_score&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;masked_fill&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;inf&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type_as&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attn_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attn_prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_att&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attn_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attn_vec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attn_prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wv&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attn_vec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;permute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contiguous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_output_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;triu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_ones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;diagonal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EncoderBlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Encoder block of a Transformer model.&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#Can&amp;#39;t use Sequential directly cause more than one input...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_inner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mha&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_inner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ff_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DecoderBlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Decoder block of a Transformer model.&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#Can&amp;#39;t use Sequential directly cause more than one input...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_inner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mha1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mha2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_inner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ff_p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask_out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mha2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mha1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inp_vsz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_vsz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                 &lt;span class=&quot;n&quot;&gt;d_inner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_emb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TransformerEmbedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp_vsz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_emb&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TransformerEmbedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_vsz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_inner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;double_drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ModuleList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EncoderBlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ModuleList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DecoderBlock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_vsz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_emb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mask_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_output_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_emb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_emb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To evaluate your model you will be using the commonly used BLEU score, which is a measure for determining how closely your model's generated comment is to the real comment of a method. (This code is also copied from the NLP tutorial from Rachel Thomas)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NGram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__hash__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ngram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_grams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NGram&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_correct_ngrams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pred_grams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ_grams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_grams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_grams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pred_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ_cnt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred_grams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ_grams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targ_cnt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred_cnt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]),&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred_grams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CorpusBLEU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_sz&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_sz&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;bleu&amp;#39;&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_epoch_begin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_batch_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;last_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()):&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_correct_ngrams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targ&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_sz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;
                &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on_epoch_end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_metrics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;precs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corrects&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;counts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;len_penalty&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;exp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ_len&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pred_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targ_len&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;bleu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;len_penalty&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;add_metrics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_metrics&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bleu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_x_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_y_vocab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;itos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_x_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_y_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Learner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_trn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CorpusBLEU&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_y_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CrossEntropyFlat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now you are going to use the awesome Learning Rate finder provided by FastAI, which is based on the awesome paper from Leslie N. Smith &lt;a href=&quot;https://arxiv.org/abs/1506.01186&quot;&gt;&quot;Cyclical Learning Rates for Training Neural Networks&quot;&lt;/a&gt;. This way you don't have to do a bunch of hyperparameter searching to find the perfect fit.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr_find&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recorder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;suggestion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='0' class='' max='1', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      0.00% [0/1 00:00&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: left;&quot;&gt;
      &lt;th&gt;epoch&lt;/th&gt;
      &lt;th&gt;train_loss&lt;/th&gt;
      &lt;th&gt;valid_loss&lt;/th&gt;
      &lt;th&gt;accuracy&lt;/th&gt;
      &lt;th&gt;bleu&lt;/th&gt;
      &lt;th&gt;time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
  &lt;/tbody&gt;
&lt;/table&gt;&lt;p&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='92' class='' max='423', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      21.75% [92/423 01:21&amp;lt;04:53 19.5654]
    &lt;/div&gt;
    
&amp;lt;/div&amp;gt;

&amp;lt;/div&amp;gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;LR Finder is complete, type {learner_name}.recorder.plot() to see the graph.
Min numerical gradient: 3.02E-03
Min loss divided by 10: 1.74E-02
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
QmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&amp;lt;/div&amp;gt;
&amp;lt;/div&amp;gt;

&amp;lt;/div&amp;gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;It is common to pick a point a bit before the suggested point.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;5e-4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;DRUM ROLL PLEASE!!!!!&lt;/strong&gt; You are now going to finally start training your model! Specifically for 8 epochs because that was what was in the original code in the NLP course and it also happened to work the best during my training. However, you are also implementing a few call backs, namely automatically saving the best performing model, early stopping, and showing the training and validation loss graph. Since you are using early stopping, feel free to try out a higher epoch number and the training will stop once it starts not improving.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;5e-4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Trains a model using save model, early stopping, and show graph call backs.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;callback_fns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SaveModelCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;every&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;improvement&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;monitor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;valid_loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{model_name}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;_save_model&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EarlyStoppingCallback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;monitor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;valid_loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_delta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;patience&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ShowGraph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_one_cycle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;div_factor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callback_fns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;comment_gen&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Training on Google Colab can take anywhere from ~20 to 60 minutes depending on the type of GPU they give you. So, relax, get an IV caffeine drip going, and let your model cook in peace :).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_lr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: left;&quot;&gt;
      &lt;th&gt;epoch&lt;/th&gt;
      &lt;th&gt;train_loss&lt;/th&gt;
      &lt;th&gt;valid_loss&lt;/th&gt;
      &lt;th&gt;accuracy&lt;/th&gt;
      &lt;th&gt;bleu&lt;/th&gt;
      &lt;th&gt;time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1.182219&lt;/td&gt;
      &lt;td&gt;1.133453&lt;/td&gt;
      &lt;td&gt;0.828182&lt;/td&gt;
      &lt;td&gt;0.791774&lt;/td&gt;
      &lt;td&gt;06:46&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0.920205&lt;/td&gt;
      &lt;td&gt;0.954264&lt;/td&gt;
      &lt;td&gt;0.841556&lt;/td&gt;
      &lt;td&gt;0.799681&lt;/td&gt;
      &lt;td&gt;06:47&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;0.812330&lt;/td&gt;
      &lt;td&gt;0.875513&lt;/td&gt;
      &lt;td&gt;0.849487&lt;/td&gt;
      &lt;td&gt;0.804000&lt;/td&gt;
      &lt;td&gt;06:44&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;0.752023&lt;/td&gt;
      &lt;td&gt;0.828835&lt;/td&gt;
      &lt;td&gt;0.853668&lt;/td&gt;
      &lt;td&gt;0.807183&lt;/td&gt;
      &lt;td&gt;06:45&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;0.679716&lt;/td&gt;
      &lt;td&gt;0.794862&lt;/td&gt;
      &lt;td&gt;0.856593&lt;/td&gt;
      &lt;td&gt;0.809325&lt;/td&gt;
      &lt;td&gt;06:43&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;0.653454&lt;/td&gt;
      &lt;td&gt;0.777795&lt;/td&gt;
      &lt;td&gt;0.859418&lt;/td&gt;
      &lt;td&gt;0.811010&lt;/td&gt;
      &lt;td&gt;06:42&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;0.611860&lt;/td&gt;
      &lt;td&gt;0.770059&lt;/td&gt;
      &lt;td&gt;0.860419&lt;/td&gt;
      &lt;td&gt;0.812164&lt;/td&gt;
      &lt;td&gt;06:49&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;0.605370&lt;/td&gt;
      &lt;td&gt;0.769881&lt;/td&gt;
      &lt;td&gt;0.860601&lt;/td&gt;
      &lt;td&gt;0.812119&lt;/td&gt;
      &lt;td&gt;06:45&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Better model found at epoch 0 with valid_loss value: 1.133453130722046.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Better model found at epoch 1 with valid_loss value: 0.9542644023895264.
Better model found at epoch 2 with valid_loss value: 0.8755126595497131.
Better model found at epoch 3 with valid_loss value: 0.8288350701332092.
Better model found at epoch 4 with valid_loss value: 0.7948615550994873.
Better model found at epoch 5 with valid_loss value: 0.7777946591377258.
Better model found at epoch 6 with valid_loss value: 0.7700592279434204.
Better model found at epoch 7 with valid_loss value: 0.7698812484741211.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Evaluate-your-model&quot;&gt;Evaluate your model&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluate-your-model&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let us now evaluated your trained model on some of your validation set so see how well your model is generating comments.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DatasetType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Valid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],[],[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yb&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;progress_bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ds_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='16' class='' max='16', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      100.00% [16/16 00:08&amp;lt;00:00]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;print_results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Just a little helper function for printing out the results from your model.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode_spec_tokens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_spm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DecodePieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Target:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode_spec_tokens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_spm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DecodePieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Predicted:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode_spec_tokens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;comment_spm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DecodePieces&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
&lt;span class=&quot;n&quot;&gt;print_results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input: xxbos @doesservicerequest private void putrangeinternal(final filerange range, final filerangeoperationtype operationtype, final byte[] data, final long length, final String md5, final accesscondition accesscondition, final filerequestoptions options, final operationcontext opcontext) throws storageexception { executionengine.executewithretry(this.fileserviceclient, this, putrangeimpl(range, operationtype, data, length, md5, accesscondition, options, opcontext), options.getretrypolicyfactory(), opcontext); } xxeos 

Target: xxbos Used for both uploadrange and clearrange. xxeos 

Predicted: xxbos Put to creating thes( s( xxeos 

Input: xxbos public static byte[] encodesequence(byte[]... encodedvalues) { int length = 0; for (byte[] encodedvalue : encodedvalues) { length += encodedvalue.length; } byte[] lengthencoded = encodelength(length); bytearraydataoutput out = bytestreams.newdataoutput(1 + lengthencoded.length + length); out.write(sequence_tag); out.write(lengthencoded); for (byte[] entry : encodedvalues) { out.write(entry); } return out.tobytearray(); } xxeos 

Target: xxbos Encodes a sequence of encoded values. xxeos 

Predicted: xxbos Encodes a byte of bytes bytes into xxeos 

Input: xxbos @override public String dnsresolveex(string host) { stringbuilder result = new stringbuilder(); try { inetaddress[] list = inetaddress.getallbyname(host); for (inetaddress inetaddress : list) { result.append(inetaddress.gethostaddress()); result.append(&amp;#34;; &amp;#34;); } } catch (unknownhostexception e) { log.log(level.fine, &amp;#34;DNS name not resolvable {0}.&amp;#34;, host); } return result.tostring(); } xxeos 

Target: xxbos *********************************************************************** dnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveexdnsresolveex xxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeosxxeos 

Predicted: xxbos xxmap 51 * namepp  =pxxeos 

Input: xxbos protected void removeallfromattributevalueset() { final collection&amp;lt;abstracthtml5sharedobject&amp;gt; sharedobjects = getsharedobjects(); boolean listenerinvoked = false; final collection&amp;lt;writelock&amp;gt; writelocks = lockandgetwritelocks(); try { getattributevalueset().clear(); setmodified(true); invokevaluechangelisteners(sharedobjects); listenerinvoked = true; } finally { for (final Lock lock : writelocks) { lock.unlock(); } } pushqueues(sharedobjects, listenerinvoked); } xxeos 

Target: xxbos clears all values from the value set. xxeos 

Predicted: xxbos s all attribute from the    xxeos 

Input: xxbos public void registercheckwithnotes(string checkid, String name, String script, long interval, @suppresswarnings(&amp;#34;sameparametervalue&amp;#34;) String notes) { Check check = new Check(); check.setid(checkid); check.setname(name); check.setscript(script); check.setinterval(string.format(&amp;#34; ⁇ ss&amp;#34;, interval)); check.setnotes(notes); registercheck(check); } xxeos 

Target: xxbos Registers a Health Check with the Agent. xxeos 

Predicted: xxbos Registers a xxupj ealth checkxxmaj  check a givenxxmaj  name xxeos 

Input: xxbos public void assertequalsignoringcase(@nullable Description description, @nullable String actual, @nullable String expected) { if (!areequalignoringcase(actual, expected)) { String format = &amp;#34;expecting:&amp;lt; ⁇ s&amp;gt; to be equal to:&amp;lt; ⁇ s&amp;gt;, ignoring case considerations&amp;#34;; throw failures.failure(description, new basicerrormessagefactory(format, actual, expected)); } } xxeos 

Target: xxbos Verifies that two s are equal, ignoring case considerations. xxeos 

Predicted: xxbos Assert that the stringsxx are equal, oring the... xxeos 

Input: xxbos protected cronschedulebuilder createcronschedulebuilder(string cronexpr) { int i = cronexpr.indexof(&amp;#34;[&amp;#34;); int j = cronexpr.indexof(&amp;#34;]&amp;#34;); timezone timezone = defaulttimezone; if (i &amp;gt; -1 &amp;amp;&amp;amp; j &amp;gt; -1) { timezone = timezone.gettimezone(cronexpr.substring(i+1, j)); cronexpr = cronexpr.substring(0, i).trim(); } return cronschedulebuilder.cronschedule(cronexpr).intimezone(timezone); } xxeos 

Target: xxbos Allow timezone to be configured on a per-cron basis with [timezonename] appended to the cron format xxeos 

Predicted: xxbos Create to to create used to the mtimei-s of a0],]. to the givenath.xxeos 

Input: xxbos private &amp;lt;T&amp;gt; fakeencodeditem readnextitem(class&amp;lt;t&amp;gt; clazz) { fakeencodeditem item = data[dataposition]; if (item == null) { / / While Parcel will treat these as zeros, in tests, this is almost always an error. throw new unreliablebehaviorerror(&amp;#34;reading uninitialized data at position &amp;#34; + dataposition); } checkconsistentreadandincrementposition(clazz, item); return item; } xxeos 

Target: xxbos Reads a complete item in the byte buffer. xxeos 

Predicted: xxbos Read the   from the given array. xxeos 

Input: xxbos private void hidesuggestionsifnecessary(final @nonnull querytoken currentquery, final @nonnull tokensource source) { String queryts = currentquery.gettokenstring(); String currentts = source.getcurrenttokenstring(); if (!iswaitingforresults(currentquery) &amp;amp;&amp;amp; queryts != null &amp;amp;&amp;amp; queryts.equals(currentts)) { msuggestionsvisibilitymanager.displaysuggestions(false); } } xxeos 

Target: xxbos Hides the suggestions if there are no more incoming queries. xxeos 

Predicted: xxbos Check the givenion of of the is no more  . xxeos 

Input: xxbos public list&amp;lt;uirow&amp;gt; getvalues() throws efapsexception { list&amp;lt;uirow&amp;gt; ret = new arraylist&amp;lt;&amp;gt;(); if (isfiltered()) { for (final uirow row : this.values) { boolean filtered = false; for (final tablefilter filter : this.filters.values()) { filtered = filter.filterrow(row); if (filtered) { break; } } if (!filtered) { ret.add(row); } } } else { ret = this.values; } setsize(ret.size()); return ret; } xxeos 

Target: xxbos This is the getter method for the instance variable . xxeos 

Predicted: xxbos Returns method a first method for the row of. xxeos 

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This is great and all. However, you can see the text looks a bit off. Your model sort of starts generating some word and then switches half way through sometimes. This is because the way you are currently trying to generate tokens is using &lt;a href=&quot;https://towardsdatascience.com/what-is-teacher-forcing-3da6217fed1c&quot;&gt;Teacher Forcing&lt;/a&gt;, which means you are giving the model the groundtruth for what it should have produced even if it did not. This is very helpful during training, however, it expects to have both the x and y of an input. In a real world setting, you aren't going to be given the y, obviously!&lt;/p&gt;
&lt;p&gt;Therefore, I found a hacky way of bypassing this need for the y so that it is no longer needed. This involves using an empty array that fakes being the y, but has only ones and is updated everytime the model makes a prediction and is then fed back into the model so that is knows what it has generated before.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Heads Up&lt;/strong&gt; The way I coded this is extremely inefficient and so running it will take a long time to generate predictions. Therefore I recommend only generating a few comments (I set it up to only do 10).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TODO For You:&lt;/strong&gt; Come up with a more efficient solution that performs similarly to the Teacher Forcing approach of the above code.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;P.S.&lt;/p&gt;
&lt;p&gt;For other &lt;a href=&quot;https://docs.fast.ai/text.learner.html#LanguageLearner.predict&quot;&gt;language learners&lt;/a&gt; provided by FastAI, you can simply use the &lt;code&gt;predict&lt;/code&gt; function and pass some text and ask for the model to predict the next set of tokens. However, I have been unsuccessful in implementing this &lt;code&gt;predict&lt;/code&gt; function for Sequence to Sequence models. So, another &lt;strong&gt;TODO For You&lt;/strong&gt; is to see if you can implement a &lt;code&gt;predict&lt;/code&gt; function for Sequence to Sequence models so that you can easily generate comments for methods that you just pass to the function!&lt;/p&gt;
&lt;p&gt;If you do figure out a way to do this, I would be extremely interested! So, feel free to leave a comment about it.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse_show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inpts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trgts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;yb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;progress_bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DatasetType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;long&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;outs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;inpts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;trgts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reconstruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inpts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trgts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db_tst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;print_results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;comment_spm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;

    &lt;div&gt;
        &lt;style&gt;
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        &lt;/style&gt;
      &amp;lt;progress value='10' class='' max='149', style='width:300px; height:20px; vertical-align: middle;'&amp;gt;&amp;lt;/progress&amp;gt;
      6.71% [10/149 01:14&amp;lt;17:21]
    &lt;/div&gt;
    
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input: xxbos protected String parseunquotedstringcontent() { final int startndx = ndx; while (true) { final char c = input[ndx]; if (c &amp;lt;= &amp;#39; &amp;#39; || charutil.equalsone(c, UNQUOTED_DELIMETERS)) { final int currentndx = ndx; / / done skipwhitespaces(); return new String(input, startndx, currentndx - startndx); } ndx++; } } xxeos 

Target: xxbos Parses un-quoted string content. xxeos 

Predicted: xxbos Parses the text from the HTML text. xxeos 

Input: xxbos private static void checkfilecopy(final File srcfile, final File destfile) throws ioexception { checkexists(srcfile); checkisfile(srcfile); if (equals(srcfile, destfile)) { throw new ioexception(&amp;#34;files &amp;#39;&amp;#34; + srcfile + &amp;#34;&amp;#39; and &amp;#39;&amp;#34; + destfile + &amp;#34;&amp;#39; are equal&amp;#34;); } File destparent = destfile.getparentfile(); if (destparent != null &amp;amp;&amp;amp; !destparent.exists()) { checkcreatedirectory(destparent); } } xxeos 

Target: xxbos Checks that file copy can occur. xxeos 

Predicted: xxbos Checks if the file is a file. xxeos 

Input: xxbos long analyze() { Arc a; Arc aa; if (pre.outs == null) { return flags.reg_uimpossible; } for (a = pre.outs; a != null; a = a.outchain) { for (aa = a.to.outs; aa != null; aa = aa.outchain) { if (aa.to == post) { return flags.reg_uemptymatch; } } } return 0; } xxeos 

Target: xxbos analyze - ascertain potentially-useful facts about an optimized NFA xxeos 

Predicted: xxbos Returns the Syoooo Syna Syna Syna Sa Sa Sa Sa Sa Sa Sa Sa syna Syna xxeos 

Input: xxbos @suppresswarnings(&amp;#34;unchecked&amp;#34;) public REC next() { checkdirection(true); orecord record; / / ITERATE UNTIL THE NEXT GOOD RECORD while (hasnext()) { / / FOUND if (currentrecord != null) { try { return (REC) currentrecord; } finally { currentrecord = null; } } record = gettransactionentry(); if (record != null) return (REC) record; } return null; } xxeos 

Target: xxbos Return the element at the current position and move forward the cursor to the next position available. xxeos 

Predicted: xxbos Returns the next record in the queue. xxeos 

Input: xxbos public static void addtransitivematches(hollowreadstateengine stateengine, map&amp;lt;string, bitset&amp;gt; matches) { list&amp;lt;hollowschema&amp;gt; schemalist = hollowschemasorter.dependencyorderedschemalist(stateengine); collections.reverse(schemalist); for(hollowschema schema : schemalist) { bitset currentmatches = matches.get(schema.getname()); if(currentmatches != null) { addtransitivematches(stateengine, schema.getname(), matches); } } } xxeos 

Target: xxbos Augment the given selection by adding the references, and the &amp;lt;i&amp;gt;transitive&amp;lt; / i&amp;gt; references, of our selection. xxeos 

Predicted: xxbos Add a variable to the list of s. xxeos 

Input: xxbos protected void resolvenestedproperties(final beanproperty bp) { String name = bp.name; int dotndx; while ((dotndx = indexofdot(name)) != -1) { bp.last = false; bp.setname(name.substring(0, dotndx)); bp.updatebean(getindexproperty(bp)); name = name.substring(dotndx + 1); } bp.last = true; bp.setname(name); } xxeos 

Target: xxbos Resolves nested property name to the very last indexed property. If forced, &amp;lt;code&amp;gt;null&amp;lt; / code&amp;gt; or non-existing properties will be created. xxeos 

Predicted: xxbos Resolve the property name. xxeos 

Input: xxbos public xmlconfig declarenamespace(string prefix, String namespaceuri) { validate.notempty(prefix, &amp;#34;prefix cannot be empty&amp;#34;); validate.notempty(namespaceuri, &amp;#34;namespace URI cannot be empty&amp;#34;); map&amp;lt;string, String&amp;gt; updatednamespaces = new hashmap&amp;lt;string, string&amp;gt;(declarednamespaces); updatednamespaces.put(prefix, namespaceuri); return new xmlconfig(features, updatednamespaces, properties, validating, true, allowdoctypedeclaration, true); } xxeos 

Target: xxbos Declares a namespace and also sets } to &amp;lt;code&amp;gt;true&amp;lt; / code&amp;gt;. &amp;lt;p / &amp;gt; &amp;lt;p&amp;gt;note that you cannot use this to add namespaces for the matcher. This has to be done by providing a to the matcher instance.&amp;lt; / p&amp;gt; xxeos 

Predicted: xxbos Creates a new instance of the given name and the given name. xxeos 

Input: xxbos protected static int getshadowradius(drawable shadow, Drawable circle) { int radius = 0; if (shadow != null &amp;amp;&amp;amp; circle != null) { Rect rect = new Rect(); radius = (circle.getintrinsicwidth() + (shadow.getpadding(rect) ? rect.left + rect.right : 0)) / 2; } return Math.max(1, radius); } xxeos 

Target: xxbos Calculates required radius of shadow. xxeos 

Predicted: xxbos Get the Syyyy Syyy Syyy Syna Syna Syna Syna Syna Sna Syna Syna Syna xxeos 

Input: xxbos void addadviceclinitmethod(final String name) { if (adviceclinits == null) { adviceclinits = new arraylist&amp;lt;&amp;gt;(); } adviceclinits.add(name); } xxeos 

Target: xxbos Saves used static initialization blocks (clinit) of advices. xxeos 

Predicted: xxbos Adds a Java class to the Saa Sa Sa Syyetch Bean. xxeos 

Input: xxbos public static String padleft(string s, int desiredlength, String padstring) { while (s.length() &amp;lt; desiredlength) { s = padstring + s; } return s; } xxeos 

Target: xxbos Pad the given string with padstring on the left up to the given length. xxeos 

Predicted: xxbos Compares two strings, and returns the first character in the string. xxeos 

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Not too shabby if I do say so myself! It seems to actually be learning about what a comment is supposed to have in it for documenting what the method is doing. Of course there are a lot of tweaks you could do such as adding the ability to generate inline comments instead of just method level, using more data, using different sampling schemes for generating the comments such as &lt;a href=&quot;https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277&quot;&gt;top-k or nucleus&lt;/a&gt;, and any other awesome things you could think of! And if you do feel free to leave a comment about your adventure.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Tip:&lt;/strong&gt;
I have done a lot of fiddling to get this to work, however, most of my models ended up overfitting. The way I fixed this issue was just being more careful in how I clean the data and also increase the data size. I know this seems simple, but it is quite effective.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this tutorial, you created an Automatic Code Comment Generator! You learned about how to clean, explore, and process data and how to use the awesome Pytorch and FastAI to define and train the awesome Transformer architecture. The use of Deep Learning in the field of Software Engineering is what I am studying for my Ph.D., so I hope I have inspired you to think about some other ways you could use Deep Learning to help Software Engineering!&lt;/p&gt;
&lt;p&gt;I hope you enjoyed this tutorial and look out for future blog posts from me about all kinds of topics as I have announced a challenge for myself for learning new things this year!

&lt;center&gt;
    &lt;div class=&quot;jekyll-twitter-plugin&quot;&gt;&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Okay, I&amp;#39;m posing a &lt;a href=&quot;https://twitter.com/hashtag/challenge?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#challenge&lt;/a&gt; to myself: Each month devote an hour a day to learning about a subject I am weak at. At the end of the month, post a blog summarizing what you&amp;#39;ve learned.&lt;br /&gt;&lt;br /&gt;March is devoted to &lt;a href=&quot;https://twitter.com/hashtag/neuroscience?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#neuroscience&lt;/a&gt;! Already signed up for &lt;a href=&quot;https://twitter.com/hashtag/edX?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#edX&lt;/a&gt; course!&lt;a href=&quot;https://twitter.com/hashtag/ChallengeAccepted?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#ChallengeAccepted&lt;/a&gt; 😎&lt;/p&gt;&amp;mdash; Nathan Cooper (@ncooper57) &lt;a href=&quot;https://twitter.com/ncooper57/status/1235408134904086529?ref_src=twsrc%5Etfw&quot;&gt;March 5, 2020&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/center&gt;
&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&amp;lt;/div&amp;gt;
 

&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://nathancooper.io/i-am-a-nerd/images/comment_gen_preview.png" /><media:content medium="image" url="https://nathancooper.io/i-am-a-nerd/images/comment_gen_preview.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>